/**
 * @fileoverview added by tsickle
 * Generated from: workflows/ls-workflow-model-viewer/ls-workflow-model-viewer.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ContentChild, Input } from '@angular/core';
import { WorkflowModel } from '../../shared/model/workflows/workflow-model';
import { StepState } from '../../shared/model/workflows/step-state';
export class LsWorkflowModelViewerComponent {
    // messages = CircuitDisplayMessages;
    constructor() {
        this.isInstance = false;
        this.isOver = false;
        this.isRejected = false;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (!this.circuit) {
            console.error('Missing input circuit data');
            this.circuit = new WorkflowModel();
        }
        if (!this.messages) {
            throw new Error('Missing localised messages for LsWorkflowViewerComponent!');
        }
        if (!this.getStepIconClassFct) {
            throw new Error('Missing getStepIconClassFct for LsWorkflowViewerComponent!');
        }
        if (!this.getStepTooltipFct) {
            throw new Error('Missing getStepTooltipFct for LsWorkflowViewerComponent!');
        }
    }
    /**
     * @return {?}
     */
    ngOnChanges() {
        console.debug('LsWorkflowViewerComponent::ngOnChanges, ', this);
        if (this.isInstance) {
            console.debug('LsWorkflowViewerComponent::ngOnChanges - circuit is an instance ');
            /** @type {?} */
            const workflow = (/** @type {?} */ (this.circuit));
            this.activeStep = workflow.currentStepIdx;
            this.isOver = workflow.isOver;
            this.isRejected = workflow.rejected;
        }
    }
    /**
     * @param {?} step
     * @return {?}
     */
    getStepIconClass(step) {
        return this.getStepIconClassFct(step);
    }
    /**
     * @param {?} step
     * @return {?}
     */
    getStepTooltip(step) {
        return this.getStepTooltipFct(step);
    }
    /**
     * @param {?} stepIdx
     * @return {?}
     */
    isActiveStep(stepIdx) {
        return !this.isRejected && !this.isOver && stepIdx === this.activeStep;
    }
    /**
     * @param {?} step
     * @return {?}
     */
    isPassed(step) {
        return this.isInstance && ((step.state === StepState.VALIDATED) || (step.state === StepState.REJECTED));
    }
    /**
     * @param {?} step
     * @param {?} validator
     * @return {?}
     */
    isActualValidator(step, validator) {
        return this.isInstance && (step.validatedBy.some((/**
         * @param {?} elem
         * @return {?}
         */
        (elem) => elem.id === validator.id)));
    }
    /**
     * @return {?}
     */
    isCircuitOver() {
        return this.isOver && !this.isRejected;
    }
    /**
     * @return {?}
     */
    getCircuitEndAdditionalClasses() {
        if (this.getCircuitEndAdditionalClassesFct) {
            return this.getCircuitEndAdditionalClassesFct();
        }
        return '';
    }
    /**
     * @param {?} step
     * @param {?} validator
     * @return {?}
     */
    getValidatorClasses(step, validator) {
        if (this.isActualValidator(step, validator)) {
            if (step.state === StepState.REJECTED) {
                return this.messages.REJECTED_BY_ICON_CLASS;
            }
            else {
                return this.messages.VALIDATED_BY_ICON_CLASS;
            }
        }
        return '';
    }
}
LsWorkflowModelViewerComponent.decorators = [
    { type: Component, args: [{
                selector: 'ls-workflow-model-viewer',
                template: "<div class=\"ls-workflow-display\">\n  <div class=\"ls-workflow-canevas\">\n    <div class=\"circuit-start\">\n      <div class=\"ls-workflow-endpoint-content\">\n        <span class=\"ls-workflow-endpoint-icn fa fa fa-2x\" [ngClass]=\"messages.CIRCUIT_START_ICON\"></span>\n        <span class=\"ls-step-bounds-txt\" [innerText]=\"messages.FIRST_STEP_TXT\"></span>\n      </div>\n    </div>\n    <div class=\"steps-container\">\n      <div *ngFor=\"let step of circuit.steps; index as i\" >\n        <div class=\"ls-workflow-display-step-container\">\n          <div  class=\"ls-workflow-step\" [ngClass]=\"isActiveStep(i) ? 'wa-active-step wa-white-icn' : ''\">\n            <div class=\"ls-step-top-line\">\n              <div class=\"step-number\">{{i + 1}}.</div>\n              <div class=\"step-name\">{{step.name}}</div>\n              <div [ngClass]=\"getStepIconClass(step)\" class=\"step-icn fa\" ngbTooltip=\"{{getStepTooltip(step)}}\"></div>\n            </div>\n            <div class=\"ls-display-step-separator\"></div>\n            <div class=\"ls-step-validator-list\" [ngClass]=\"isInstance ? 'wa-circuit-instance' : ''\">\n              <ng-container *ngIf=\"isPassed(step)\">\n                <div *ngFor=\"let validator of step.validators\">\n                  <ng-template\n                    [ngTemplateOutlet]=\"passedStepTemplateRef\"\n                    [ngTemplateOutletContext]=\"{step: step, validator: validator}\">\n                  </ng-template>\n                </div>\n              </ng-container>\n              <ng-container *ngIf=\" ! isPassed(step)\">\n                <div *ngFor=\"let validator of step.validators\">\n                  <ng-template\n                    [ngTemplateOutlet]=\"pendingStepTemplateRef\"\n                    [ngTemplateOutletContext]=\"{step: step, validator: validator}\">\n                  </ng-template>\n                </div>\n              </ng-container>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"ls-workflow-end\">\n      <div class=\"ls-workflow-endpoint-content\" [ngClass]=\"getCircuitEndAdditionalClasses()\">\n        <span class=\"ls-workflow-endpoint-icn fa fa-2x\" [ngClass]=\"messages.CIRCUIT_END_ICON\"></span>\n        <span class=\"ls-step-bounds-txt\" [innerText]=\"messages.LAST_STEP_TXT\"></span>\n      </div>\n    </div>\n  </div>\n</div>\n",
                styles: ["@charset \"UTF-8\";body{background-color:var(--ls-grey-50)}.active-btn{color:#42a1e8}.ls-workflow-canevas{-ms-flex-align:center;-ms-flex-direction:column;-ms-flex-pack:start;-ms-grid-column:1;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:vertical;-webkit-box-pack:start;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:column;grid-column:1;height:100%;justify-content:flex-start}.ls-workflow-step{-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);background-color:#fff;border:none;box-shadow:0 0 .25rem rgba(0,0,0,.15);min-height:6rem;width:var(--ls-workflow-step-width,20rem)}.ls-workflow-step .ls-step-top-line{-ms-flex-align:center;-ms-flex-direction:row;-ms-flex-pack:justify;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:justify;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;font-weight:700;justify-content:space-between;padding:.5rem}.ls-workflow-step .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-step .ls-step-validator-list{color:#5b5b5b;padding:.5rem .5rem .5rem 1.5rem}.ls-workflow-step.selected{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.ls-workflow-step .step-icn{height:1.7rem;width:1.7rem}.ls-workflow-endpoint-content{margin:auto;text-align:center}.ls-workflow-endpoint-content .ls-step-bounds-txt{color:var(--primary);font-weight:700}.ls-workflow-endpoint-content .ls-workflow-endpoint-icn{color:var(--primary)}.ls-workflow-endpoint-content.not-active .ls-step-bounds-txt,.ls-workflow-endpoint-content.not-active .ls-workflow-endpoint-icn{color:#5b5b5b}.ls-workflow-endpoint-content .ls-step-validator-list{text-align:left}.ls-actual-validator{font-weight:700}.ls-actual-validator:before{color:var(--primary);content:\"\uF00C\";font-family:FontAwesome;font-size:1em;left:.5em;position:absolute}.ls-rejector{font-weight:700}.ls-rejector:before{color:var(--danger);content:\"\uF00D\";font-family:FontAwesome;font-size:1em;left:.5em;position:absolute}.wa-comment-icon{color:var(--primary);font-size:1em;margin-right:.5em}.ls-workflow-display .ls-workflow-step{margin:1rem auto;padding-left:0;padding-right:0}.ls-workflow-display .ls-workflow-step .ls-step-validator-list{padding:1rem 1rem 1rem .5rem}.ls-workflow-display .ls-workflow-step .ls-step-validator-list.ls-workflow-instance{padding-left:2rem}.ls-workflow-display .ls-workflow-endpoint-content{-ms-flex-direction:row;-webkit-box-direction:normal;-webkit-box-orient:horizontal;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row}.ls-workflow-display .ls-workflow-endpoint-content .ls-step-bounds-txt{margin-left:.5rem}.ls-workflow-display .ls-step-top-line{-ms-flex-pack:start;-webkit-box-pack:start;justify-content:flex-start;padding-left:.5rem}.ls-workflow-display .ls-step-top-line .step-name{-ms-flex:1;-webkit-box-flex:1;flex:1;margin-left:.7rem}.ls-workflow-display .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-display .ls-workflow-display-step-container{position:relative}.ls-workflow-display .ls-active-step .ls-step-top-line{background-color:var(--primary);color:#fff;margin:0}.ls-workflow-display .ls-active-step .ls-step-top-line .step-icn{color:#fff}.ls-workflow-display .ls-active-step:before{color:var(--primary);content:\"\uF061\";font-family:FontAwesome;font-size:2em;left:-1em;position:absolute}.ls-workflow-display .ls-active-step.end-step:before{font-size:1.2em}.ls-workflow-end{position:relative}"]
            }] }
];
/** @nocollapse */
LsWorkflowModelViewerComponent.ctorParameters = () => [];
LsWorkflowModelViewerComponent.propDecorators = {
    passedStepTemplateRef: [{ type: ContentChild, args: ['passedStepContent',] }],
    pendingStepTemplateRef: [{ type: ContentChild, args: ['pendingStepContent',] }],
    circuit: [{ type: Input }],
    activeStep: [{ type: Input }],
    messages: [{ type: Input }],
    getStepIconClassFct: [{ type: Input }],
    getStepTooltipFct: [{ type: Input }],
    getCircuitEndAdditionalClassesFct: [{ type: Input }],
    isInstance: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.passedStepTemplateRef;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.pendingStepTemplateRef;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.circuit;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.activeStep;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.messages;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.getStepIconClassFct;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.getStepTooltipFct;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.getCircuitEndAdditionalClassesFct;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.isInstance;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.isOver;
    /** @type {?} */
    LsWorkflowModelViewerComponent.prototype.isRejected;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHMtd29ya2Zsb3ctbW9kZWwtdmlld2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIvYnVpbGRzL291dGlscy9jaGFydGVncmFwaGlxdWUvbGlicmFpcmllLWFuZ3VsYXIvbGliL3NyYy93b3JrZmxvd3Mvc3JjLyIsInNvdXJjZXMiOlsid29ya2Zsb3dzL2xzLXdvcmtmbG93LW1vZGVsLXZpZXdlci9scy13b3JrZmxvdy1tb2RlbC12aWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFxQixNQUFNLGVBQWUsQ0FBQztBQUdsRixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFHNUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBT3BFLE1BQU0sT0FBTyw4QkFBOEI7O0lBb0J6QztRQU5TLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDNUIsV0FBTSxHQUFHLEtBQUssQ0FBQztRQUNmLGVBQVUsR0FBRyxLQUFLLENBQUM7SUFLbkIsQ0FBQzs7OztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNqQixPQUFPLENBQUMsS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7WUFDNUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLGFBQWEsRUFBRSxDQUFDO1NBQ3BDO1FBRUQsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDbEIsTUFBTSxJQUFJLEtBQUssQ0FBQywyREFBMkQsQ0FBQyxDQUFDO1NBQzlFO1FBRUQsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRTtZQUM3QixNQUFNLElBQUksS0FBSyxDQUFDLDREQUE0RCxDQUFDLENBQUM7U0FDL0U7UUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQzNCLE1BQU0sSUFBSSxLQUFLLENB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QUEwRDs7SUFDMUQsMkRBQXdEOztJQUN4RCwyRUFBOEQ7O0lBRTlELG9EQUE0Qjs7SUFDNUIsZ0RBQWU7O0lBQ2Ysb0RBQW1CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBDb250ZW50Q2hpbGQsIElucHV0LCBPbkNoYW5nZXMsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU3RlcEluc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL21vZGVsL3dvcmtmbG93cy9zdGVwLWluc3RhbmNlJztcbmltcG9ydCB7IFdvcmtmbG93QWN0b3IgfSBmcm9tICcuLi8uLi9zaGFyZWQvbW9kZWwvd29ya2Zsb3dzL3dvcmtmbG93LWFjdG9yJztcbmltcG9ydCB7IFdvcmtmbG93TW9kZWwgfSBmcm9tICcuLi8uLi9zaGFyZWQvbW9kZWwvd29ya2Zsb3dzL3dvcmtmbG93LW1vZGVsJztcbmltcG9ydCB7IFN0ZXBNb2RlbCB9IGZyb20gJy4uLy4uL3NoYXJlZC9tb2RlbC93b3JrZmxvd3Mvc3RlcC1tb2RlbCc7XG5pbXBvcnQgeyBXb3JrZmxvd0luc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL21vZGVsL3dvcmtmbG93cy93b3JrZmxvdy1pbnN0YW5jZSc7XG5pbXBvcnQgeyBTdGVwU3RhdGUgfSBmcm9tICcuLi8uLi9zaGFyZWQvbW9kZWwvd29ya2Zsb3dzL3N0ZXAtc3RhdGUnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdscy13b3JrZmxvdy1tb2RlbC12aWV3ZXInLFxuICB0ZW1wbGF0ZVVybDogJy4vbHMtd29ya2Zsb3ctbW9kZWwtdmlld2VyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbHMtd29ya2Zsb3ctbW9kZWwtdmlld2VyLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTHNXb3JrZmxvd01vZGVsVmlld2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuXG5cbiAgQENvbnRlbnRDaGlsZCgncGFzc2VkU3RlcENvbnRlbnQnKSBwYXNzZWRTdGVwVGVtcGxhdGVSZWY6IFRlbXBsYXRlUmVmPGFueT47XG4gIEBDb250ZW50Q2hpbGQoJ3BlbmRpbmdTdGVwQ29udGVudCcpIHBlbmRpbmdTdGVwVGVtcGxhdGVSZWY6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgQElucHV0KCkgY2lyY3VpdDogV29ya2Zsb3dNb2RlbCB8IFdvcmtmbG93SW5zdGFuY2U7XG4gIEBJbnB1dCgpIGFjdGl2ZVN0ZXA6IG51bWJlcjtcbiAgQElucHV0KCkgbWVzc2FnZXM6IGFueTtcblxuICBASW5wdXQoKSBnZXRTdGVwSWNvbkNsYXNzRmN0OiAoc3RlcDogU3RlcE1vZGVsKSA9PiBzdHJpbmc7XG4gIEBJbnB1dCgpIGdldFN0ZXBUb29sdGlwRmN0OiAoc3RlcDogU3RlcE1vZGVsKSA9PiBzdHJpbmc7XG4gIEBJbnB1dCgpIGdldENpcmN1aXRFbmRBZGRpdGlvbmFsQ2xhc3Nlc0ZjdDogKCkgPT4gc3RyaW5nIHwgW107XG5cbiAgQElucHV0KCkgaXNJbnN0YW5jZSA9IGZhbHNlO1xuICBpc092ZXIgPSBmYWxzZTtcbiAgaXNSZWplY3RlZCA9IGZhbHNlO1xuXG4gIC8vIG1lc3NhZ2VzID0gQ2lyY3VpdERpc3BsYXlNZXNzYWdlcztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICghdGhpcy5jaXJjdWl0KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNaXNzaW5nIGlucHV0IGNpcmN1aXQgZGF0YScpO1xuICAgICAgdGhpcy5jaXJjdWl0ID0gbmV3IFdvcmtmbG93TW9kZWwoKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMubWVzc2FnZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsb2NhbGlzZWQgbWVzc2FnZXMgZm9yIExzV29ya2Zsb3dWaWV3ZXJDb21wb25lbnQhJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmdldFN0ZXBJY29uQ2xhc3NGY3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZXRTdGVwSWNvbkNsYXNzRmN0IGZvciBMc1dvcmtmbG93Vmlld2VyQ29tcG9uZW50IScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5nZXRTdGVwVG9vbHRpcEZjdCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdldFN0ZXBUb29sdGlwRmN0IGZvciBMc1dvcmtmbG93Vmlld2VyQ29tcG9uZW50IScpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIGNvbnNvbGUuZGVidWcoJ0xzV29ya2Zsb3dWaWV3ZXJDb21wb25lbnQ6Om5nT25DaGFuZ2VzLCAnLCB0aGlzKTtcbiAgICBpZiAodGhpcy5pc0luc3RhbmNlKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKCdMc1dvcmtmbG93Vmlld2VyQ29tcG9uZW50OjpuZ09uQ2hhbmdlcyAtIGNpcmN1aXQgaXMgYW4gaW5zdGFuY2UgJyk7XG4gICAgICBjb25zdCB3b3JrZmxvdyA9IHRoaXMuY2lyY3VpdCBhcyBXb3JrZmxvd0luc3RhbmNlO1xuICAgICAgdGhpcy5hY3RpdmVTdGVwID0gd29ya2Zsb3cuY3VycmVudFN0ZXBJZHg7XG4gICAgICB0aGlzLmlzT3ZlciA9IHdvcmtmbG93LmlzT3ZlcjtcbiAgICAgIHRoaXMuaXNSZWplY3RlZCA9IHdvcmtmbG93LnJlamVjdGVkO1xuICAgIH1cbiAgfVxuXG4gIGdldFN0ZXBJY29uQ2xhc3Moc3RlcDogU3RlcE1vZGVsKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTdGVwSWNvbkNsYXNzRmN0KHN0ZXApO1xuICB9XG5cbiAgZ2V0U3RlcFRvb2x0aXAoc3RlcDogU3RlcE1vZGVsKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTdGVwVG9vbHRpcEZjdChzdGVwKTtcbiAgfVxuXG4gIGlzQWN0aXZlU3RlcChzdGVwSWR4OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMuaXNSZWplY3RlZCAmJiAhdGhpcy5pc092ZXIgJiYgc3RlcElkeCA9PT0gdGhpcy5hY3RpdmVTdGVwO1xuICB9XG5cbiAgaXNQYXNzZWQoc3RlcDogU3RlcEluc3RhbmNlKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNJbnN0YW5jZSAmJiAoKHN0ZXAuc3RhdGUgPT09IFN0ZXBTdGF0ZS5WQUxJREFURUQpIHx8IChzdGVwLnN0YXRlID09PSBTdGVwU3RhdGUuUkVKRUNURUQpKTtcbiAgfVxuXG4gIGlzQWN0dWFsVmFsaWRhdG9yKHN0ZXA6IFN0ZXBJbnN0YW5jZSwgdmFsaWRhdG9yOiBXb3JrZmxvd0FjdG9yKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNJbnN0YW5jZSAmJiAoc3RlcC52YWxpZGF0ZWRCeS5zb21lKChlbGVtKSA9PiBlbGVtLmlkID09PSB2YWxpZGF0b3IuaWQpKTtcbiAgfVxuXG4gIGlzQ2lyY3VpdE92ZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNPdmVyICYmICF0aGlzLmlzUmVqZWN0ZWQ7XG4gIH1cblxuICBnZXRDaXJjdWl0RW5kQWRkaXRpb25hbENsYXNzZXMoKSB7XG5cbiAgICBpZiAodGhpcy5nZXRDaXJjdWl0RW5kQWRkaXRpb25hbENsYXNzZXNGY3QpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldENpcmN1aXRFbmRBZGRpdGlvbmFsQ2xhc3Nlc0ZjdCgpO1xuICAgIH1cblxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGdldFZhbGlkYXRvckNsYXNzZXMoc3RlcDogU3RlcEluc3RhbmNlLCB2YWxpZGF0b3I6IFdvcmtmbG93QWN0b3IpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmlzQWN0dWFsVmFsaWRhdG9yKHN0ZXAsIHZhbGlkYXRvcikpIHtcbiAgICAgIGlmIChzdGVwLnN0YXRlID09PSBTdGVwU3RhdGUuUkVKRUNURUQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZXMuUkVKRUNURURfQllfSUNPTl9DTEFTUztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VzLlZBTElEQVRFRF9CWV9JQ09OX0NMQVNTO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gJyc7XG4gIH1cblxufVxuIl19