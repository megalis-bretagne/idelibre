/**
 * @fileoverview added by tsickle
 * Generated from: workflows/ls-workflow-editor/ls-workflow-editor.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ContentChild, EventEmitter, Input, Output, QueryList, TemplateRef, ViewChild, ViewChildren } from '@angular/core';
import { NgbPopover } from '@ng-bootstrap/ng-bootstrap';
import { WorkflowModel } from '../../shared/model/workflows/workflow-model';
import { StepModel } from '../../shared/model/workflows/step-model';
import { moveItemInArray } from '@angular/cdk/drag-drop';
import { WorkflowModelLocalizedMessages, WorkflowModelOptions } from '../../shared/model/workflows/workflow-model-options';
var LsWorkflowEditorComponent = /** @class */ (function () {
    function LsWorkflowEditorComponent() {
        this.messages = {
            CREATE_STEP_TITLE: 'Ajouter une étape',
            EDIT_STEP_TITLE: 'Modification de l\'étape',
            ADD_STEP_BTN_TXT: 'Ajouter une étape',
            FIRST_STEP_TXT: 'Début',
            LAST_STEP_TXT: 'Fin',
        };
        this.activeOptions = {
            startIconClass: 'far fa-flag',
            endIconClass: 'fas fa-flag-checkered',
            editorGlobalLayoutClass: 'ls-workflow-editor-default-layout',
            additionalFinalEndpointClasses: ''
        };
        this.endpointIsEditable = false;
        this.workflowChange = new EventEmitter();
    }
    Object.defineProperty(LsWorkflowEditorComponent.prototype, "localizedMessages", {
        get: /**
         * @return {?}
         */
        function () {
            return this.messages;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.messages = Object.assign(this.messages, value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LsWorkflowEditorComponent.prototype, "options", {
        get: /**
         * @return {?}
         */
        function () {
            return this.activeOptions;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.activeOptions = Object.assign(this.activeOptions, value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LsWorkflowEditorComponent.prototype, "workflow", {
        get: /**
         * @return {?}
         */
        function () {
            return this.workflowData;
        },
        set: /**
         * @param {?} newValue
         * @return {?}
         */
        function (newValue) {
            this.workflowData = newValue;
            this.workflowChange.emit(newValue);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (!this.workflowData) {
            console.error('Missing input workflow data');
            this.workflowData = new WorkflowModel();
        }
        if (!this.messages) {
            throw new Error('Missing localised messages for LsWorkflowViewerComponent!');
        }
    };
    /**
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.workflowDataChanged = /**
     * @return {?}
     */
    function () {
        this.workflowChange.emit(this.workflowData);
    };
    /**
     * @param {?} stepIdx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.askForStepDeletion = /**
     * @param {?} stepIdx
     * @return {?}
     */
    function (stepIdx) {
        var _this = this;
        console.debug('delete step');
        if (this.confirmStepDeletionFct) {
            this.confirmStepDeletionFct(this.workflowData.steps[stepIdx]).then((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                if (result) {
                    _this.deleteStep(stepIdx);
                }
            }));
        }
        else {
            this.deleteStep(stepIdx);
        }
    };
    /**
     * @param {?} stepData
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.confirmStepCreation = /**
     * @param {?} stepData
     * @param {?} idx
     * @return {?}
     */
    function (stepData, idx) {
        this.addStep(stepData, idx);
        this.closeCurrentPopover();
    };
    /**
     * @param {?} stepData
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.confirmStepEdition = /**
     * @param {?} stepData
     * @param {?} idx
     * @return {?}
     */
    function (stepData, idx) {
        this.replaceStep(stepData, idx);
        this.closeCurrentPopover();
    };
    /**
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.confirmFinalStepEdition = /**
     * @return {?}
     */
    function () {
        this.closeCurrentPopover();
    };
    /**
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.cancelStepEdition = /**
     * @return {?}
     */
    function () {
        this.closeCurrentPopover();
    };
    /**
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.cancelStepCreation = /**
     * @param {?} idx
     * @return {?}
     */
    function (idx) {
        this.closeCurrentPopover();
    };
    /**
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.isFirstStep = /**
     * @return {?}
     */
    function () {
        return (!this.workflowData || this.workflowData.steps.length === 0);
    };
    /**
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.getAdditionalStepClass = /**
     * @param {?} idx
     * @return {?}
     */
    function (idx) {
        if (this.currentEditedStepIdx !== null && this.currentEditedStepIdx === idx) {
            return 'selected';
        }
        return '';
    };
    /**
     * @param {?} step
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.getStepIconClass = /**
     * @param {?} step
     * @return {?}
     */
    function (step) {
        if (this.getStepIconClassFct) {
            return this.getStepIconClassFct(step);
        }
        return '';
    };
    /**
     * @param {?} step
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.getStepTooltip = /**
     * @param {?} step
     * @return {?}
     */
    function (step) {
        if (this.getStepTooltipFct) {
            return this.getStepTooltipFct(step);
        }
        return '';
    };
    /**
     * @param {?} src
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.cloneStep = /**
     * @param {?} src
     * @return {?}
     */
    function (src) {
        return src.clone();
    };
    /**
     * @param {?} stepIdx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.createStep = /**
     * @param {?} stepIdx
     * @return {?}
     */
    function (stepIdx) {
        var _this = this;
        /** @type {?} */
        var newStep = new StepModel();
        this.currentPopover = this.getCreationPopoverForIdx(stepIdx);
        this.currentPopover.hidden.subscribe((/**
         * @return {?}
         */
        function () { return _this.cancelStepCreation(stepIdx); }));
        this.currentPopover.open({
            stepData: newStep,
            idx: stepIdx,
            cancelStepCreation: this.cancelStepCreation.bind(this),
            confirmStepCreation: this.confirmStepCreation.bind(this)
        });
    };
    /**
     * @param {?} stepIdx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.editStep = /**
     * @param {?} stepIdx
     * @return {?}
     */
    function (stepIdx) {
        var _this = this;
        this.currentEditedStepIdx = stepIdx;
        /** @type {?} */
        var editingStep = this.cloneStep(this.workflowData.steps[stepIdx]);
        this.currentPopover = this.getEditionPopoverForIdx(stepIdx);
        this.currentPopover.hidden.subscribe((/**
         * @return {?}
         */
        function () { return _this.cancelStepEdition(); }));
        this.currentPopover.open({
            stepData: editingStep,
            idx: stepIdx,
            cancelStepEdition: this.cancelStepEdition.bind(this),
            confirmStepEdition: this.confirmStepEdition.bind(this)
        });
    };
    /**
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.editFinalStep = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var editingStep = this.cloneStep(this.lastStepData);
        this.currentPopover = this.endpointPopoverElementRef;
        this.currentPopover.hidden.subscribe((/**
         * @return {?}
         */
        function () { return _this.cancelStepEdition(); }));
        this.currentPopover.open({
            stepData: editingStep,
            cancelStepEdition: this.cancelStepEdition.bind(this),
            confirmStepEdition: this.confirmFinalStepEdition.bind(this)
        });
    };
    /**
     * @param {?} event
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.drop = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        moveItemInArray(this.workflowData.steps, event.previousIndex, event.currentIndex);
        this.workflowDataChanged();
    };
    /**
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.dragDisabledForIdx = /**
     * @param {?} idx
     * @return {?}
     */
    function (idx) {
        return (this.currentEditedStepIdx !== null && this.currentEditedStepIdx === idx);
    };
    /**
     * @private
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.closeCurrentPopover = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.currentPopover && this.currentPopover.isOpen()) {
            this.currentPopover.close();
        }
        this.currentPopover = null;
        this.currentEditedStepIdx = null;
    };
    /**
     * @private
     * @param {?} step
     * @param {?} pos
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.addStep = /**
     * @private
     * @param {?} step
     * @param {?} pos
     * @return {?}
     */
    function (step, pos) {
        this.workflowData.steps.splice(pos, 0, step);
        this.workflowDataChanged();
    };
    /**
     * @private
     * @param {?} newStep
     * @param {?} stepIdx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.replaceStep = /**
     * @private
     * @param {?} newStep
     * @param {?} stepIdx
     * @return {?}
     */
    function (newStep, stepIdx) {
        this.workflowData.steps.splice(stepIdx, 1, newStep);
        this.workflowDataChanged();
    };
    /**
     * @private
     * @param {?} stepIdx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.deleteStep = /**
     * @private
     * @param {?} stepIdx
     * @return {?}
     */
    function (stepIdx) {
        this.workflowData.steps.splice(stepIdx, 1);
        this.workflowDataChanged();
    };
    /**
     * @private
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.getCreationPopoverForIdx = /**
     * @private
     * @param {?} idx
     * @return {?}
     */
    function (idx) {
        /** @type {?} */
        var filteredList = this.allCircuitEditionPopover.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            /** @type {?} */
            var elem = ((/** @type {?} */ (item)))._elementRef;
            if (elem && elem.nativeElement) {
                return elem.nativeElement.hasAttribute('create-btn');
            }
            return true;
        }));
        return filteredList[idx];
    };
    /**
     * @private
     * @param {?} idx
     * @return {?}
     */
    LsWorkflowEditorComponent.prototype.getEditionPopoverForIdx = /**
     * @private
     * @param {?} idx
     * @return {?}
     */
    function (idx) {
        /** @type {?} */
        var filteredList = this.allCircuitEditionPopover.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            /** @type {?} */
            var elem = ((/** @type {?} */ (item)))._elementRef;
            if (elem && elem.nativeElement) {
                return !(elem.nativeElement.hasAttribute('create-btn'));
            }
            return true;
        }));
        return filteredList[idx];
    };
    LsWorkflowEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ls-workflow-editor',
                    template: "<div class=\"ls-workflow-editor\" [ngClass]=\"options.editorGlobalLayoutClass\">\n  <div class=\"ls-workflow-canevas\">\n    <div class=\"ls-workflow-start ls-workflow-endpoint\">\n      <div class=\"ls-workflow-endpoint-content\">\n        <div class=\"ls-workflow-endpoint-icn fa fa-2x\" [ngClass]=\"options.startIconClass\"></div>\n        <div class=\"ls-step-bounds-txt\">{{messages.FIRST_STEP_TXT}}</div>\n      </div>\n    </div>\n    <div class=\"ls-workflow-stepList-container\" cdkDropList (cdkDropListDropped)=\"drop($event)\">\n      <div class=\"ls-workflow-link-container\">\n        <div class=\"ls-workflow-link\"></div>\n        <div [ngClass]=\"isFirstStep() ? 'firstStep' : ''\" class=\"ls-link-button-container\">\n          <div (click)=\"createStep(0)\" [autoClose]=\"'outside'\" [ngbPopover]=\"popCreateContent\"\n               [popoverTitle]=\"messages.popCreateTitle\" class=\"add-step-btn\" create-btn\n               placement=\"right\" popoverClass=\"ls-step-edition-popover\"\n               triggers=\"manual\"\n               autoClose=\"false\">\n            <span class=\"fa fa-plus-circle\"></span>\n            <span class=\"add-step-btn-txt\">{{messages.ADD_STEP_BTN_TXT}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div *ngFor=\"let step of workflowData.steps; index as i\">\n        <div class=\"ls-workflow-step-container\" cdkDrag [cdkDragDisabled]=\"dragDisabledForIdx(i)\">\n          <div [ngClass]=\"getAdditionalStepClass(i)\" class=\"ls-workflow-step\">\n            <div class=\"ls-step-top-line\">\n              <div class=\"step-number\">{{i + 1}}.</div>\n              <div class=\"step-name\">{{step.name}}</div>\n              <div [ngClass]=\"getStepIconClass(step)\" class=\"step-icn fa\" ngbTooltip=\"{{getStepTooltip(step)}}\"></div>\n            </div>\n            <div class=\"ls-step-validator-list\">\n              <ng-template\n                [ngTemplateOutlet]=\"stepDisplayContentRef\"\n                [ngTemplateOutletContext]=\"{step: step}\">\n              </ng-template>\n            </div>\n          </div>\n          <div class=\"ls-workflow-step-external-buttons\">\n            <div (click)=\"editStep(i)\" [autoClose]=\"'outside'\" [ngbPopover]=\"popEditContent\"\n                 [popoverTitle]=\"messages.popEditTitle\" class=\"fa fa-pencil-alt fa-pencil edit-step-btn\"\n                 placement=\"right-top\"\n                 popoverClass=\"ls-step-edition-popover\"\n                 triggers=\"manual\"></div>\n            <div (click)=\"askForStepDeletion(i)\" class=\"fa fa-trash delete-step-btn\"></div>\n          </div>\n        </div>\n\n        <div class=\"ls-workflow-link-container\">\n          <div class=\"ls-workflow-link\"></div>\n          <div class=\"ls-link-button-container\">\n            <div (click)=\"createStep(i + 1)\" [autoClose]=\"'outside'\" [ngbPopover]=\"popCreateContent\"\n                 [popoverTitle]=\"messages.popCreateTitle\" class=\"add-step-btn\" create-btn\n                 placement=\"right\" popoverClass=\"ls-step-edition-popover\"\n                 triggers=\"manual\"\n                 autoClose=\"false\">\n              <span class=\"fa fa-plus-circle\"></span>\n              <span class=\"add-step-btn-txt\">{{messages.ADD_STEP_BTN_TXT}}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n    <div class=\"ls-workflow-end ls-workflow-endpoint\" [ngClass]=\"options.additionalFinalEndpointClasses\">\n      <ng-container *ngIf=\"endpointIsEditable\">\n        <div\n          #endpointPopoverHandle\n          (click)=\"editFinalStep()\"\n          [autoClose]=\"'outside'\"\n          [ngbPopover]=\"popEditFinalStepContent\"\n          [popoverTitle]=\"messages.popEditTitle\"\n          class=\"ls-workflow-endpoint-overlay\"\n          placement=\"right\"\n          popoverClass=\"ls-step-edition-popover\"\n          triggers=\"manual\">\n\n        </div>\n      </ng-container>\n      <div class=\"ls-workflow-endpoint-content\">\n        <div class=\"ls-workflow-endpoint-icn-group\">\n          <div class=\"ls-workflow-endpoint-icn fa fa-2x\" [ngClass]=\"options.endIconClass\"></div>\n          <div class=\"ls-step-bounds-txt\">{{messages.LAST_STEP_TXT}}</div>\n        </div>\n        <div *ngIf=\"endpointIsEditable\" class=\"ls-step-validator-list\">\n          <ng-template [ngTemplateOutlet]=\"lastStepDisplayContentRef\">\n          </ng-template>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n<ng-template\n  #popEditContent\n  let-idx=\"idx\"\n  let-stepData=\"stepData\"\n  let-cancelStepEdition=\"cancelStepEdition\"\n  let-confirmStepEdition=\"confirmStepEdition\">\n  <ng-template\n    [ngTemplateOutlet]=\"popEditContentTemplateRef\"\n    [ngTemplateOutletContext]=\"{idx:idx, stepData:stepData, cancelStepEdition:cancelStepEdition, confirmStepEdition:confirmStepEdition}\">\n  </ng-template>\n</ng-template>\n\n<ng-template\n  #popCreateContent\n  let-idx=\"idx\"\n  let-stepData=\"stepData\"\n  let-cancelStepCreation=\"cancelStepCreation\"\n  let-confirmStepCreation=\"confirmStepCreation\">\n  <ng-template\n    [ngTemplateOutlet]=\"popCreateContentTemplateRef\"\n    [ngTemplateOutletContext]=\"{idx:idx, stepData:stepData, cancelStepCreation:cancelStepCreation, confirmStepCreation:confirmStepCreation}\">\n  </ng-template>\n</ng-template>\n\n\n<ng-template\n  #popEditFinalStepContent\n  let-stepData=\"stepData\"\n  let-cancelStepEdition=\"cancelStepEdition\"\n  let-confirmStepEdition=\"confirmStepEdition\">\n  <ng-template\n    [ngTemplateOutlet]=\"endpointPopoverEditContentRef\"\n    [ngTemplateOutletContext]=\"{stepData:stepData, cancelStepEdition:cancelStepEdition, confirmStepEdition:confirmStepEdition, isLastStep:true}\">\n  </ng-template>\n</ng-template>\n",
                    styles: ["body{background-color:var(--ls-grey-50)}.active-btn{color:#42a1e8}.ls-workflow-canevas{-ms-grid-column:1;grid-column:1;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.ls-workflow-endpoint.with-content,.ls-workflow-step{background-color:#fff;-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);box-shadow:0 0 .25rem rgba(0,0,0,.15);border:none;width:var(--ls-workflow-step-width,20rem);min-height:6rem}.ls-workflow-endpoint.with-content .ls-step-top-line,.ls-workflow-step .ls-step-top-line{padding:.5rem;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-weight:700}.ls-workflow-endpoint.with-content .ls-display-step-separator,.ls-workflow-step .ls-display-step-separator{width:100%;border-bottom:1px solid #d3d3d3}.ls-workflow-endpoint.with-content .ls-step-validator-list,.ls-workflow-step .ls-step-validator-list{padding:.5rem .5rem .5rem 1.5rem;color:#5b5b5b}.ls-workflow-step.selected,.selected.ls-workflow-endpoint.with-content{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.ls-workflow-endpoint.with-content .step-icn,.ls-workflow-step .step-icn{width:1.7rem;height:1.7rem}.ls-workflow-endpoint-content{margin:auto;text-align:center}.ls-workflow-endpoint-content .ls-step-bounds-txt{color:var(--primary);font-weight:700}.ls-workflow-endpoint-content .ls-workflow-endpoint-icn{color:var(--primary)}.ls-workflow-endpoint-content.not-active .ls-step-bounds-txt,.ls-workflow-endpoint-content.not-active .ls-workflow-endpoint-icn{color:#5b5b5b}.ls-workflow-endpoint-content .ls-step-validator-list{text-align:left}.ls-horizontal-separation-line{margin-top:2rem;border-bottom:1px solid #5b5b5b}.ls-workflow-endpoint{background-color:#fff;-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);box-shadow:0 0 .25rem rgba(0,0,0,.15);border:none;display:-ms-grid;display:grid;width:6rem;height:6rem;border-radius:50%;position:relative}.ls-workflow-endpoint.with-content{display:block;width:var(--ls-workflow-step-width,20rem);border-radius:0}.ls-workflow-endpoint.with-content .ls-workflow-endpoint-content{width:100%;height:100%;padding:.5em}.ls-workflow-endpoint.with-content .ls-workflow-endpoint-content .ls-workflow-endpoint-icn-group{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;padding:0 .5em}.ls-workflow-endpoint.with-content .ls-workflow-endpoint-content .ls-workflow-endpoint-icn-group:after{content:'';display:block;width:2em}.ls-workflow-endpoint .ls-workflow-endpoint-overlay{width:100%;height:100%;position:absolute;left:0;bottom:0;z-index:2;cursor:pointer}.ls-workflow-link{width:0;border:1px solid #222}.cdk-drag-preview .ls-workflow-endpoint.with-content,.cdk-drag-preview .ls-workflow-step{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.cdk-drag-placeholder{min-height:6rem}.cdk-drag-placeholder .ls-workflow-endpoint.with-content,.cdk-drag-placeholder .ls-workflow-step,.cdk-drag-placeholder .ls-workflow-step-external-buttons{display:none}.cdk-drop-list-dragging .cdk-drag{-webkit-transition:-webkit-transform 250ms cubic-bezier(0,0,.2,1);transition:transform 250ms cubic-bezier(0,0,.2,1);transition:transform 250ms cubic-bezier(0,0,.2,1),-webkit-transform 250ms cubic-bezier(0,0,.2,1)}.cdk-drag-animating{-webkit-transition:-webkit-transform .3s cubic-bezier(0,0,.2,1);transition:transform .3s cubic-bezier(0,0,.2,1);transition:transform .3s cubic-bezier(0,0,.2,1),-webkit-transform .3s cubic-bezier(0,0,.2,1)}.ls-workflow-link-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;min-height:4rem;min-width:20rem}.ls-workflow-link-container::before{content:\"\";-webkit-box-flex:0;-ms-flex:0 0 calc(50% - 2px);flex:0 0 calc(50% - 2px)}.ls-workflow-link-container .ls-link-button-container{-webkit-box-flex:0;-ms-flex:0 0 calc(50% - 2px);flex:0 0 calc(50% - 2px);-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;height:-webkit-min-content;height:-moz-min-content;height:min-content;width:-webkit-min-content;width:-moz-min-content;width:min-content;padding-left:1rem}.ls-workflow-stepList-container{width:100%}.ls-workflow-step-container{-ms-flex-item-align:center;align-self:center;margin-left:auto;margin-right:auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.ls-workflow-step-container::before{content:\"\";-webkit-box-flex:0;-ms-flex:0 0 5rem;flex:0 0 5rem}.ls-workflow-step-container .ls-workflow-endpoint.with-content,.ls-workflow-step-container .ls-workflow-step{-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center}.ls-workflow-step-container .ls-workflow-step-external-buttons{padding-left:1rem;height:-webkit-min-content;height:-moz-min-content;height:min-content;-webkit-box-flex:0;-ms-flex:0 0 5rem;flex:0 0 5rem}.ls-workflow-step-external-buttons{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.ls-workflow-step-external-buttons .edit-step-btn{margin-right:1rem;cursor:pointer}.ls-workflow-step-external-buttons .edit-step-btn:hover{color:var(--primary)}.ls-workflow-step-external-buttons .delete-step-btn{cursor:pointer}.ls-workflow-step-external-buttons .delete-step-btn:hover{color:var(--danger)}.ls-workflow-editor{display:-ms-grid;display:grid;height:100%}.ls-workflow-editor .ls-link-button-container .add-step-btn{width:-webkit-max-content;width:-moz-max-content;width:max-content;cursor:pointer}.ls-workflow-editor .ls-link-button-container .add-step-btn .add-step-btn-txt{margin-left:.5em;opacity:0;-webkit-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out}.ls-workflow-editor .ls-link-button-container.firstStep .add-step-btn .add-step-btn-txt,.ls-workflow-editor .ls-link-button-container:hover .add-step-btn .add-step-btn-txt{opacity:100}.ls-workflow-editor-default-layout{-ms-grid-columns:66% auto;grid-template-columns:66% auto;-ms-grid-rows:100%;grid-template-rows:100%}@media (min-width:1400px){.container{max-width:1340px}}@media (min-width:1600px){.container{max-width:1540px}}"]
                }] }
    ];
    /** @nocollapse */
    LsWorkflowEditorComponent.ctorParameters = function () { return []; };
    LsWorkflowEditorComponent.propDecorators = {
        endpointPopoverElementRef: [{ type: ViewChild, args: ['endpointPopoverHandle', { read: NgbPopover },] }],
        allCircuitEditionPopover: [{ type: ViewChildren, args: [NgbPopover,] }],
        popEditContentTemplateRef: [{ type: ContentChild, args: ['popEditContent',] }],
        popCreateContentTemplateRef: [{ type: ContentChild, args: ['popCreateContent',] }],
        endpointPopoverEditContentRef: [{ type: ContentChild, args: ['endpointPopoverEditContent',] }],
        stepDisplayContentRef: [{ type: ContentChild, args: ['stepDisplayContent',] }],
        lastStepDisplayContentRef: [{ type: ContentChild, args: ['lastStepDisplayContent',] }],
        endpointIsEditable: [{ type: Input }],
        getStepIconClassFct: [{ type: Input }],
        getStepTooltipFct: [{ type: Input }],
        confirmStepDeletionFct: [{ type: Input }],
        lastStepData: [{ type: Input }],
        workflowChange: [{ type: Output }],
        localizedMessages: [{ type: Input }],
        options: [{ type: Input }],
        workflow: [{ type: Input }]
    };
    return LsWorkflowEditorComponent;
}());
export { LsWorkflowEditorComponent };
if (false) {
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.currentEditedStepIdx;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.endpointPopoverElementRef;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.allCircuitEditionPopover;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.currentPopover;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.popEditContentTemplateRef;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.popCreateContentTemplateRef;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.endpointPopoverEditContentRef;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.stepDisplayContentRef;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.lastStepDisplayContentRef;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.messages;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.activeOptions;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.endpointIsEditable;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.getStepIconClassFct;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.getStepTooltipFct;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.confirmStepDeletionFct;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.lastStepData;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.workflowData;
    /** @type {?} */
    LsWorkflowEditorComponent.prototype.workflowChange;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHMtd29ya2Zsb3ctZWRpdG9yLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BsaWJyaWNpZWwvbHMtY29tcG9zYW50cy93b3JrZmxvd3MvIiwic291cmNlcyI6WyJ3b3JrZmxvd3MvbHMtd29ya2Zsb3ctZWRpdG9yL2xzLXdvcmtmbG93LWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFlBQVksRUFDWixZQUFZLEVBQ1osS0FBSyxFQUVMLE1BQU0sRUFDTixTQUFTLEVBQ1QsV0FBVyxFQUNYLFNBQVMsRUFDVCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3hELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQUM1RSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDcEUsT0FBTyxFQUFlLGVBQWUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3RFLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHFEQUFxRCxDQUFDO0FBRTNIO0lBNENFO1FBdkJBLGFBQVEsR0FBbUM7WUFDekMsaUJBQWlCLEVBQUUsbUJBQW1CO1lBQ3RDLGVBQWUsRUFBRSwwQkFBMEI7WUFDM0MsZ0JBQWdCLEVBQUUsbUJBQW1CO1lBQ3JDLGNBQWMsRUFBRSxPQUFPO1lBQ3ZCLGFBQWEsRUFBRSxLQUFLO1NBQ3JCLENBQUM7UUFDRixrQkFBYSxHQUF5QjtZQUNwQyxjQUFjLEVBQUUsYUFBYTtZQUM3QixZQUFZLEVBQUUsdUJBQXVCO1lBQ3JDLHVCQUF1QixFQUFFLG1DQUFtQztZQUM1RCw4QkFBOEIsRUFBRSxFQUFFO1NBQ25DLENBQUM7UUFDTyx1QkFBa0IsR0FBRyxLQUFLLENBQUM7UUFRMUIsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBaUIsQ0FB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QTRCOztJQUM1QixtREFBNkQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIENvbnRlbnRDaGlsZCxcbiAgRXZlbnRFbWl0dGVyLFxuICBJbnB1dCxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFF1ZXJ5TGlzdCxcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NoaWxkcmVuXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTmdiUG9wb3ZlciB9IGZyb20gJ0BuZy1ib290c3RyYXAvbmctYm9vdHN0cmFwJztcbmltcG9ydCB7IFdvcmtmbG93TW9kZWwgfSBmcm9tICcuLi8uLi9zaGFyZWQvbW9kZWwvd29ya2Zsb3dzL3dvcmtmbG93LW1vZGVsJztcbmltcG9ydCB7IFN0ZXBNb2RlbCB9IGZyb20gJy4uLy4uL3NoYXJlZC9tb2RlbC93b3JrZmxvd3Mvc3RlcC1tb2RlbCc7XG5pbXBvcnQgeyBDZGtEcmFnRHJvcCwgbW92ZUl0ZW1JbkFycmF5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2RyYWctZHJvcCc7XG5pbXBvcnQgeyBXb3JrZmxvd01vZGVsTG9jYWxpemVkTWVzc2FnZXMsIFdvcmtmbG93TW9kZWxPcHRpb25zIH0gZnJvbSAnLi4vLi4vc2hhcmVkL21vZGVsL3dvcmtmbG93cy93b3JrZmxvdy1tb2RlbC1vcHRpb25zJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbHMtd29ya2Zsb3ctZWRpdG9yJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2xzLXdvcmtmbG93LWVkaXRvci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xzLXdvcmtmbG93LWVkaXRvci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIExzV29ya2Zsb3dFZGl0b3JDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuXG4gIGN1cnJlbnRFZGl0ZWRTdGVwSWR4OiBudW1iZXI7XG5cbiAgQFZpZXdDaGlsZCgnZW5kcG9pbnRQb3BvdmVySGFuZGxlJywge3JlYWQ6IE5nYlBvcG92ZXJ9KSBlbmRwb2ludFBvcG92ZXJFbGVtZW50UmVmOiBOZ2JQb3BvdmVyO1xuICBAVmlld0NoaWxkcmVuKE5nYlBvcG92ZXIpIGFsbENpcmN1aXRFZGl0aW9uUG9wb3ZlcjogUXVlcnlMaXN0PE5nYlBvcG92ZXI+O1xuICBjdXJyZW50UG9wb3ZlcjogTmdiUG9wb3ZlcjtcblxuXG4gIEBDb250ZW50Q2hpbGQoJ3BvcEVkaXRDb250ZW50JykgcG9wRWRpdENvbnRlbnRUZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8YW55PjtcbiAgQENvbnRlbnRDaGlsZCgncG9wQ3JlYXRlQ29udGVudCcpIHBvcENyZWF0ZUNvbnRlbnRUZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8YW55PjtcbiAgQENvbnRlbnRDaGlsZCgnZW5kcG9pbnRQb3BvdmVyRWRpdENvbnRlbnQnKSBlbmRwb2ludFBvcG92ZXJFZGl0Q29udGVudFJlZjogVGVtcGxhdGVSZWY8YW55PjtcbiAgQENvbnRlbnRDaGlsZCgnc3RlcERpc3BsYXlDb250ZW50Jykgc3RlcERpc3BsYXlDb250ZW50UmVmOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBAQ29udGVudENoaWxkKCdsYXN0U3RlcERpc3BsYXlDb250ZW50JykgbGFzdFN0ZXBEaXNwbGF5Q29udGVudFJlZjogVGVtcGxhdGVSZWY8YW55PjtcblxuXG4gIG1lc3NhZ2VzOiBXb3JrZmxvd01vZGVsTG9jYWxpemVkTWVzc2FnZXMgPSB7XG4gICAgQ1JFQVRFX1NURVBfVElUTEU6ICdBam91dGVyIHVuZSDDqXRhcGUnLFxuICAgIEVESVRfU1RFUF9USVRMRTogJ01vZGlmaWNhdGlvbiBkZSBsXFwnw6l0YXBlJyxcbiAgICBBRERfU1RFUF9CVE5fVFhUOiAnQWpvdXRlciB1bmUgw6l0YXBlJyxcbiAgICBGSVJTVF9TVEVQX1RYVDogJ0TDqWJ1dCcsXG4gICAgTEFTVF9TVEVQX1RYVDogJ0ZpbicsXG4gIH07XG4gIGFjdGl2ZU9wdGlvbnM6IFdvcmtmbG93TW9kZWxPcHRpb25zID0ge1xuICAgIHN0YXJ0SWNvbkNsYXNzOiAnZmFyIGZhLWZsYWcnLFxuICAgIGVuZEljb25DbGFzczogJ2ZhcyBmYS1mbGFnLWNoZWNrZXJlZCcsXG4gICAgZWRpdG9yR2xvYmFsTGF5b3V0Q2xhc3M6ICdscy13b3JrZmxvdy1lZGl0b3ItZGVmYXVsdC1sYXlvdXQnLFxuICAgIGFkZGl0aW9uYWxGaW5hbEVuZHBvaW50Q2xhc3NlczogJydcbiAgfTtcbiAgQElucHV0KCkgZW5kcG9pbnRJc0VkaXRhYmxlID0gZmFsc2U7XG4gIEBJbnB1dCgpIGdldFN0ZXBJY29uQ2xhc3NGY3Q6IChzdGVwOiBTdGVwTW9kZWwpID0+IHN0cmluZztcbiAgQElucHV0KCkgZ2V0U3RlcFRvb2x0aXBGY3Q6IChzdGVwOiBTdGVwTW9kZWwpID0+IHN0cmluZztcbiAgQElucHV0KCkgY29uZmlybVN0ZXBEZWxldGlvbkZjdDogKHN0ZXA6IFN0ZXBNb2RlbCkgPT4gUHJvbWlzZTxib29sZWFuPjtcblxuICBASW5wdXQoKSBsYXN0U3RlcERhdGE6IFN0ZXBNb2RlbDtcblxuICB3b3JrZmxvd0RhdGE6IFdvcmtmbG93TW9kZWw7XG4gIEBPdXRwdXQoKSB3b3JrZmxvd0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8V29ya2Zsb3dNb2RlbD4oKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgfVxuXG4gIEBJbnB1dCgpIGdldCBsb2NhbGl6ZWRNZXNzYWdlcygpIHtcbiAgICByZXR1cm4gdGhpcy5tZXNzYWdlcztcbiAgfVxuXG4gIHNldCBsb2NhbGl6ZWRNZXNzYWdlcyh2YWx1ZTogV29ya2Zsb3dNb2RlbExvY2FsaXplZE1lc3NhZ2VzKSB7XG4gICAgdGhpcy5tZXNzYWdlcyA9IE9iamVjdC5hc3NpZ24odGhpcy5tZXNzYWdlcywgdmFsdWUpO1xuICB9XG5cbiAgQElucHV0KCkgZ2V0IG9wdGlvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuYWN0aXZlT3B0aW9ucztcbiAgfVxuXG4gIHNldCBvcHRpb25zKHZhbHVlOiBXb3JrZmxvd01vZGVsT3B0aW9ucykge1xuICAgIHRoaXMuYWN0aXZlT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24odGhpcy5hY3RpdmVPcHRpb25zLCB2YWx1ZSk7XG4gIH1cblxuICBASW5wdXQoKSBnZXQgd29ya2Zsb3coKTogV29ya2Zsb3dNb2RlbCB7XG4gICAgcmV0dXJuIHRoaXMud29ya2Zsb3dEYXRhO1xuICB9XG5cbiAgc2V0IHdvcmtmbG93KG5ld1ZhbHVlOiBXb3JrZmxvd01vZGVsKSB7XG4gICAgdGhpcy53b3JrZmxvd0RhdGEgPSBuZXdWYWx1ZTtcbiAgICB0aGlzLndvcmtmbG93Q2hhbmdlLmVtaXQobmV3VmFsdWUpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKCF0aGlzLndvcmtmbG93RGF0YSkge1xuICAgICAgY29uc29sZS5lcnJvcignTWlzc2luZyBpbnB1dCB3b3JrZmxvdyBkYXRhJyk7XG4gICAgICB0aGlzLndvcmtmbG93RGF0YSA9IG5ldyBXb3JrZmxvd01vZGVsKCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm1lc3NhZ2VzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbG9jYWxpc2VkIG1lc3NhZ2VzIGZvciBMc1dvcmtmbG93Vmlld2VyQ29tcG9uZW50IScpO1xuICAgIH1cblxuICB9XG5cbiAgd29ya2Zsb3dEYXRhQ2hhbmdlZCgpIHtcbiAgICB0aGlzLndvcmtmbG93Q2hhbmdlLmVtaXQodGhpcy53b3JrZmxvd0RhdGEpO1xuICB9XG5cbiAgYXNrRm9yU3RlcERlbGV0aW9uKHN0ZXBJZHg6IG51bWJlcikge1xuICAgIGNvbnNvbGUuZGVidWcoJ2RlbGV0ZSBzdGVwJyk7XG5cbiAgICBpZiAodGhpcy5jb25maXJtU3RlcERlbGV0aW9uRmN0KSB7XG4gICAgICB0aGlzLmNvbmZpcm1TdGVwRGVsZXRpb25GY3QodGhpcy53b3JrZmxvd0RhdGEuc3RlcHNbc3RlcElkeF0pLnRoZW4oXG4gICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVTdGVwKHN0ZXBJZHgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kZWxldGVTdGVwKHN0ZXBJZHgpO1xuICAgIH1cbiAgfVxuXG5cbiAgY29uZmlybVN0ZXBDcmVhdGlvbihzdGVwRGF0YTogU3RlcE1vZGVsLCBpZHg6IG51bWJlcikge1xuICAgIHRoaXMuYWRkU3RlcChzdGVwRGF0YSwgaWR4KTtcbiAgICB0aGlzLmNsb3NlQ3VycmVudFBvcG92ZXIoKTtcbiAgfVxuXG4gIGNvbmZpcm1TdGVwRWRpdGlvbihzdGVwRGF0YTogU3RlcE1vZGVsLCBpZHg6IG51bWJlcikge1xuICAgIHRoaXMucmVwbGFjZVN0ZXAoc3RlcERhdGEsIGlkeCk7XG4gICAgdGhpcy5jbG9zZUN1cnJlbnRQb3BvdmVyKCk7XG4gIH1cblxuICBjb25maXJtRmluYWxTdGVwRWRpdGlvbigpIHtcbiAgICB0aGlzLmNsb3NlQ3VycmVudFBvcG92ZXIoKTtcbiAgfVxuXG4gIGNhbmNlbFN0ZXBFZGl0aW9uKCkge1xuICAgIHRoaXMuY2xvc2VDdXJyZW50UG9wb3ZlcigpO1xuICB9XG5cbiAgY2FuY2VsU3RlcENyZWF0aW9uKGlkeDogbnVtYmVyKSB7XG4gICAgdGhpcy5jbG9zZUN1cnJlbnRQb3BvdmVyKCk7XG4gIH1cblxuICBpc0ZpcnN0U3RlcCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKCF0aGlzLndvcmtmbG93RGF0YSB8fCB0aGlzLndvcmtmbG93RGF0YS5zdGVwcy5sZW5ndGggPT09IDApO1xuICB9XG5cbiAgZ2V0QWRkaXRpb25hbFN0ZXBDbGFzcyhpZHg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY3VycmVudEVkaXRlZFN0ZXBJZHggIT09IG51bGwgJiYgdGhpcy5jdXJyZW50RWRpdGVkU3RlcElkeCA9PT0gaWR4KSB7XG4gICAgICByZXR1cm4gJ3NlbGVjdGVkJztcbiAgICB9XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgZ2V0U3RlcEljb25DbGFzcyhzdGVwOiBTdGVwTW9kZWwpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmdldFN0ZXBJY29uQ2xhc3NGY3QpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFN0ZXBJY29uQ2xhc3NGY3Qoc3RlcCk7XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGdldFN0ZXBUb29sdGlwKHN0ZXA6IFN0ZXBNb2RlbCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuZ2V0U3RlcFRvb2x0aXBGY3QpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFN0ZXBUb29sdGlwRmN0KHN0ZXApO1xuICAgIH1cbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBwdWJsaWMgY2xvbmVTdGVwKHNyYzogU3RlcE1vZGVsKTogU3RlcE1vZGVsIHtcbiAgICByZXR1cm4gc3JjLmNsb25lKCk7XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlU3RlcChzdGVwSWR4OiBudW1iZXIpIHtcbiAgICBjb25zdCBuZXdTdGVwID0gbmV3IFN0ZXBNb2RlbCgpO1xuXG4gICAgdGhpcy5jdXJyZW50UG9wb3ZlciA9IHRoaXMuZ2V0Q3JlYXRpb25Qb3BvdmVyRm9ySWR4KHN0ZXBJZHgpO1xuICAgIHRoaXMuY3VycmVudFBvcG92ZXIuaGlkZGVuLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNhbmNlbFN0ZXBDcmVhdGlvbihzdGVwSWR4KSk7XG4gICAgdGhpcy5jdXJyZW50UG9wb3Zlci5vcGVuKFxuICAgICAge1xuICAgICAgICBzdGVwRGF0YTogbmV3U3RlcCxcbiAgICAgICAgaWR4OiBzdGVwSWR4LFxuICAgICAgICBjYW5jZWxTdGVwQ3JlYXRpb246IHRoaXMuY2FuY2VsU3RlcENyZWF0aW9uLmJpbmQodGhpcyksXG4gICAgICAgIGNvbmZpcm1TdGVwQ3JlYXRpb246IHRoaXMuY29uZmlybVN0ZXBDcmVhdGlvbi5iaW5kKHRoaXMpXG4gICAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBlZGl0U3RlcChzdGVwSWR4OiBudW1iZXIpIHtcbiAgICB0aGlzLmN1cnJlbnRFZGl0ZWRTdGVwSWR4ID0gc3RlcElkeDtcbiAgICBjb25zdCBlZGl0aW5nU3RlcCA9IHRoaXMuY2xvbmVTdGVwKHRoaXMud29ya2Zsb3dEYXRhLnN0ZXBzW3N0ZXBJZHhdKTtcblxuICAgIHRoaXMuY3VycmVudFBvcG92ZXIgPSB0aGlzLmdldEVkaXRpb25Qb3BvdmVyRm9ySWR4KHN0ZXBJZHgpO1xuICAgIHRoaXMuY3VycmVudFBvcG92ZXIuaGlkZGVuLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNhbmNlbFN0ZXBFZGl0aW9uKCkpO1xuICAgIHRoaXMuY3VycmVudFBvcG92ZXIub3Blbih7XG4gICAgICBzdGVwRGF0YTogZWRpdGluZ1N0ZXAsXG4gICAgICBpZHg6IHN0ZXBJZHgsXG4gICAgICBjYW5jZWxTdGVwRWRpdGlvbjogdGhpcy5jYW5jZWxTdGVwRWRpdGlvbi5iaW5kKHRoaXMpLFxuICAgICAgY29uZmlybVN0ZXBFZGl0aW9uOiB0aGlzLmNvbmZpcm1TdGVwRWRpdGlvbi5iaW5kKHRoaXMpXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgZWRpdEZpbmFsU3RlcCgpIHtcbiAgICBjb25zdCBlZGl0aW5nU3RlcCA9IHRoaXMuY2xvbmVTdGVwKHRoaXMubGFzdFN0ZXBEYXRhKTtcbiAgICB0aGlzLmN1cnJlbnRQb3BvdmVyID0gdGhpcy5lbmRwb2ludFBvcG92ZXJFbGVtZW50UmVmO1xuICAgIHRoaXMuY3VycmVudFBvcG92ZXIuaGlkZGVuLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNhbmNlbFN0ZXBFZGl0aW9uKCkpO1xuICAgIHRoaXMuY3VycmVudFBvcG92ZXIub3Blbih7XG4gICAgICBzdGVwRGF0YTogZWRpdGluZ1N0ZXAsXG4gICAgICBjYW5jZWxTdGVwRWRpdGlvbjogdGhpcy5jYW5jZWxTdGVwRWRpdGlvbi5iaW5kKHRoaXMpLFxuICAgICAgY29uZmlybVN0ZXBFZGl0aW9uOiB0aGlzLmNvbmZpcm1GaW5hbFN0ZXBFZGl0aW9uLmJpbmQodGhpcylcbiAgICB9KTtcbiAgfVxuXG4gIGRyb3AoZXZlbnQ6IENka0RyYWdEcm9wPFN0ZXBNb2RlbFtdPikge1xuICAgIG1vdmVJdGVtSW5BcnJheSh0aGlzLndvcmtmbG93RGF0YS5zdGVwcywgZXZlbnQucHJldmlvdXNJbmRleCwgZXZlbnQuY3VycmVudEluZGV4KTtcbiAgICB0aGlzLndvcmtmbG93RGF0YUNoYW5nZWQoKTtcbiAgfVxuXG4gIGRyYWdEaXNhYmxlZEZvcklkeChpZHg6IG51bWJlcikge1xuICAgIHJldHVybiAodGhpcy5jdXJyZW50RWRpdGVkU3RlcElkeCAhPT0gbnVsbCAmJiB0aGlzLmN1cnJlbnRFZGl0ZWRTdGVwSWR4ID09PSBpZHgpO1xuICB9XG5cbiAgcHJpdmF0ZSBjbG9zZUN1cnJlbnRQb3BvdmVyKCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRQb3BvdmVyICYmIHRoaXMuY3VycmVudFBvcG92ZXIuaXNPcGVuKCkpIHtcbiAgICAgIHRoaXMuY3VycmVudFBvcG92ZXIuY2xvc2UoKTtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50UG9wb3ZlciA9IG51bGw7XG4gICAgdGhpcy5jdXJyZW50RWRpdGVkU3RlcElkeCA9IG51bGw7XG4gIH1cblxuICBwcml2YXRlIGFkZFN0ZXAoc3RlcDogU3RlcE1vZGVsLCBwb3M6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMud29ya2Zsb3dEYXRhLnN0ZXBzLnNwbGljZShwb3MsIDAsIHN0ZXApO1xuICAgIHRoaXMud29ya2Zsb3dEYXRhQ2hhbmdlZCgpO1xuICB9XG5cbiAgcHJpdmF0ZSByZXBsYWNlU3RlcChuZXdTdGVwOiBTdGVwTW9kZWwsIHN0ZXBJZHg6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMud29ya2Zsb3dEYXRhLnN0ZXBzLnNwbGljZShzdGVwSWR4LCAxLCBuZXdTdGVwKTtcbiAgICB0aGlzLndvcmtmbG93RGF0YUNoYW5nZWQoKTtcbiAgfVxuXG4gIHByaXZhdGUgZGVsZXRlU3RlcChzdGVwSWR4OiBudW1iZXIpIHtcbiAgICB0aGlzLndvcmtmbG93RGF0YS5zdGVwcy5zcGxpY2Uoc3RlcElkeCwgMSk7XG4gICAgdGhpcy53b3JrZmxvd0RhdGFDaGFuZ2VkKCk7XG4gIH1cblxuICBwcml2YXRlIGdldENyZWF0aW9uUG9wb3ZlckZvcklkeChpZHg6IG51bWJlcik6IE5nYlBvcG92ZXIge1xuICAgIGNvbnN0IGZpbHRlcmVkTGlzdCA9IHRoaXMuYWxsQ2lyY3VpdEVkaXRpb25Qb3BvdmVyLmZpbHRlcihcbiAgICAgIChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IGVsZW0gPSAoaXRlbSBhcyBhbnkpLl9lbGVtZW50UmVmO1xuICAgICAgICBpZiAoZWxlbSAmJiBlbGVtLm5hdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gZWxlbS5uYXRpdmVFbGVtZW50Lmhhc0F0dHJpYnV0ZSgnY3JlYXRlLWJ0bicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSk7XG5cbiAgICByZXR1cm4gZmlsdGVyZWRMaXN0W2lkeF07XG4gIH1cblxuICBwcml2YXRlIGdldEVkaXRpb25Qb3BvdmVyRm9ySWR4KGlkeDogbnVtYmVyKTogTmdiUG9wb3ZlciB7XG4gICAgY29uc3QgZmlsdGVyZWRMaXN0ID0gdGhpcy5hbGxDaXJjdWl0RWRpdGlvblBvcG92ZXIuZmlsdGVyKFxuICAgICAgKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgZWxlbSA9IChpdGVtIGFzIGFueSkuX2VsZW1lbnRSZWY7XG4gICAgICAgIGlmIChlbGVtICYmIGVsZW0ubmF0aXZlRWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiAhKGVsZW0ubmF0aXZlRWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2NyZWF0ZS1idG4nKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9KTtcblxuICAgIHJldHVybiBmaWx0ZXJlZExpc3RbaWR4XTtcbiAgfVxuXG59XG4iXX0=