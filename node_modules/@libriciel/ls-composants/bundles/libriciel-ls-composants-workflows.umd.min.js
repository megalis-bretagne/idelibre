!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/platform-browser/animations"),require("@angular/forms"),require("@angular/common"),require("@ng-bootstrap/ng-bootstrap"),require("@angular/platform-browser"),require("@angular/cdk/drag-drop")):"function"==typeof define&&define.amd?define("@libriciel/ls-composants/workflows",["exports","@angular/core","@angular/platform-browser/animations","@angular/forms","@angular/common","@ng-bootstrap/ng-bootstrap","@angular/platform-browser","@angular/cdk/drag-drop"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).libriciel=t.libriciel||{},t.libriciel["ls-composants"]=t.libriciel["ls-composants"]||{},t.libriciel["ls-composants"].workflows={}),t.ng.core,t.ng.platformBrowser.animations,t.ng.forms,t.ng.common,t["ng-bootstrap"],t.ng.platformBrowser,t.ng.cdk.dragDrop)}(this,(function(t,e,o,n,s,i,r,l){"use strict";var a=function(){this.steps=[]};var p={PENDING:"pending",CURRENT:"current",VALIDATED:"approve",SKIPPED:"skipped",REJECTED:"rejected"},d=function(){function t(){this.isInstance=!1,this.isOver=!1,this.isRejected=!1}return t.prototype.ngOnInit=function(){if(this.circuit||(console.error("Missing input circuit data"),this.circuit=new a),!this.messages)throw new Error("Missing localised messages for LsWorkflowViewerComponent!");if(!this.getStepIconClassFct)throw new Error("Missing getStepIconClassFct for LsWorkflowViewerComponent!");if(!this.getStepTooltipFct)throw new Error("Missing getStepTooltipFct for LsWorkflowViewerComponent!")},t.prototype.ngOnChanges=function(){if(console.debug("LsWorkflowViewerComponent::ngOnChanges, ",this),this.isInstance){console.debug("LsWorkflowViewerComponent::ngOnChanges - circuit is an instance ");var t=this.circuit;this.activeStep=t.currentStepIdx,this.isOver=t.isOver,this.isRejected=t.rejected}},t.prototype.getStepIconClass=function(t){return this.getStepIconClassFct(t)},t.prototype.getStepTooltip=function(t){return this.getStepTooltipFct(t)},t.prototype.isActiveStep=function(t){return!this.isRejected&&!this.isOver&&t===this.activeStep},t.prototype.isPassed=function(t){return this.isInstance&&(t.state===p.VALIDATED||t.state===p.REJECTED)},t.prototype.isActualValidator=function(t,e){return this.isInstance&&t.validatedBy.some((function(t){return t.id===e.id}))},t.prototype.isCircuitOver=function(){return this.isOver&&!this.isRejected},t.prototype.getCircuitEndAdditionalClasses=function(){return this.getCircuitEndAdditionalClassesFct?this.getCircuitEndAdditionalClassesFct():""},t.prototype.getValidatorClasses=function(t,e){return this.isActualValidator(t,e)?t.state===p.REJECTED?this.messages.REJECTED_BY_ICON_CLASS:this.messages.VALIDATED_BY_ICON_CLASS:""},t}();d.decorators=[{type:e.Component,args:[{selector:"ls-workflow-model-viewer",template:'<div class="ls-workflow-display">\n  <div class="ls-workflow-canevas">\n    <div class="circuit-start">\n      <div class="ls-workflow-endpoint-content">\n        <span class="ls-workflow-endpoint-icn fa fa fa-2x" [ngClass]="messages.CIRCUIT_START_ICON"></span>\n        <span class="ls-step-bounds-txt" [innerText]="messages.FIRST_STEP_TXT"></span>\n      </div>\n    </div>\n    <div class="steps-container">\n      <div *ngFor="let step of circuit.steps; index as i" >\n        <div class="ls-workflow-display-step-container">\n          <div  class="ls-workflow-step" [ngClass]="isActiveStep(i) ? \'wa-active-step wa-white-icn\' : \'\'">\n            <div class="ls-step-top-line">\n              <div class="step-number">{{i + 1}}.</div>\n              <div class="step-name">{{step.name}}</div>\n              <div [ngClass]="getStepIconClass(step)" class="step-icn fa" ngbTooltip="{{getStepTooltip(step)}}"></div>\n            </div>\n            <div class="ls-display-step-separator"></div>\n            <div class="ls-step-validator-list" [ngClass]="isInstance ? \'wa-circuit-instance\' : \'\'">\n              <ng-container *ngIf="isPassed(step)">\n                <div *ngFor="let validator of step.validators">\n                  <ng-template\n                    [ngTemplateOutlet]="passedStepTemplateRef"\n                    [ngTemplateOutletContext]="{step: step, validator: validator}">\n                  </ng-template>\n                </div>\n              </ng-container>\n              <ng-container *ngIf=" ! isPassed(step)">\n                <div *ngFor="let validator of step.validators">\n                  <ng-template\n                    [ngTemplateOutlet]="pendingStepTemplateRef"\n                    [ngTemplateOutletContext]="{step: step, validator: validator}">\n                  </ng-template>\n                </div>\n              </ng-container>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="ls-workflow-end">\n      <div class="ls-workflow-endpoint-content" [ngClass]="getCircuitEndAdditionalClasses()">\n        <span class="ls-workflow-endpoint-icn fa fa-2x" [ngClass]="messages.CIRCUIT_END_ICON"></span>\n        <span class="ls-step-bounds-txt" [innerText]="messages.LAST_STEP_TXT"></span>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:['@charset "UTF-8";body{background-color:var(--ls-grey-50)}.active-btn{color:#42a1e8}.ls-workflow-canevas{-ms-flex-align:center;-ms-flex-direction:column;-ms-flex-pack:start;-ms-grid-column:1;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:vertical;-webkit-box-pack:start;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:column;grid-column:1;height:100%;justify-content:flex-start}.ls-workflow-step{-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);background-color:#fff;border:none;box-shadow:0 0 .25rem rgba(0,0,0,.15);min-height:6rem;width:var(--ls-workflow-step-width,20rem)}.ls-workflow-step .ls-step-top-line{-ms-flex-align:center;-ms-flex-direction:row;-ms-flex-pack:justify;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:justify;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;font-weight:700;justify-content:space-between;padding:.5rem}.ls-workflow-step .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-step .ls-step-validator-list{color:#5b5b5b;padding:.5rem .5rem .5rem 1.5rem}.ls-workflow-step.selected{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.ls-workflow-step .step-icn{height:1.7rem;width:1.7rem}.ls-workflow-endpoint-content{margin:auto;text-align:center}.ls-workflow-endpoint-content .ls-step-bounds-txt{color:var(--primary);font-weight:700}.ls-workflow-endpoint-content .ls-workflow-endpoint-icn{color:var(--primary)}.ls-workflow-endpoint-content.not-active .ls-step-bounds-txt,.ls-workflow-endpoint-content.not-active .ls-workflow-endpoint-icn{color:#5b5b5b}.ls-workflow-endpoint-content .ls-step-validator-list{text-align:left}.ls-actual-validator{font-weight:700}.ls-actual-validator:before{color:var(--primary);content:"";font-family:FontAwesome;font-size:1em;left:.5em;position:absolute}.ls-rejector{font-weight:700}.ls-rejector:before{color:var(--danger);content:"";font-family:FontAwesome;font-size:1em;left:.5em;position:absolute}.wa-comment-icon{color:var(--primary);font-size:1em;margin-right:.5em}.ls-workflow-display .ls-workflow-step{margin:1rem auto;padding-left:0;padding-right:0}.ls-workflow-display .ls-workflow-step .ls-step-validator-list{padding:1rem 1rem 1rem .5rem}.ls-workflow-display .ls-workflow-step .ls-step-validator-list.ls-workflow-instance{padding-left:2rem}.ls-workflow-display .ls-workflow-endpoint-content{-ms-flex-direction:row;-webkit-box-direction:normal;-webkit-box-orient:horizontal;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row}.ls-workflow-display .ls-workflow-endpoint-content .ls-step-bounds-txt{margin-left:.5rem}.ls-workflow-display .ls-step-top-line{-ms-flex-pack:start;-webkit-box-pack:start;justify-content:flex-start;padding-left:.5rem}.ls-workflow-display .ls-step-top-line .step-name{-ms-flex:1;-webkit-box-flex:1;flex:1;margin-left:.7rem}.ls-workflow-display .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-display .ls-workflow-display-step-container{position:relative}.ls-workflow-display .ls-active-step .ls-step-top-line{background-color:var(--primary);color:#fff;margin:0}.ls-workflow-display .ls-active-step .ls-step-top-line .step-icn{color:#fff}.ls-workflow-display .ls-active-step:before{color:var(--primary);content:"";font-family:FontAwesome;font-size:2em;left:-1em;position:absolute}.ls-workflow-display .ls-active-step.end-step:before{font-size:1.2em}.ls-workflow-end{position:relative}']}]}],d.ctorParameters=function(){return[]},d.propDecorators={passedStepTemplateRef:[{type:e.ContentChild,args:["passedStepContent"]}],pendingStepTemplateRef:[{type:e.ContentChild,args:["pendingStepContent"]}],circuit:[{type:e.Input}],activeStep:[{type:e.Input}],messages:[{type:e.Input}],getStepIconClassFct:[{type:e.Input}],getStepTooltipFct:[{type:e.Input}],getCircuitEndAdditionalClassesFct:[{type:e.Input}],isInstance:[{type:e.Input}]};Object.create;function c(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,s,i=o.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)r.push(n.value)}catch(t){s={error:t}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(s)throw s.error}}return r}function w(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}Object.create;var f=function(){function t(){this.validators=[]}return t.prototype.clone=function(){console.log("StepModel::clone");var e=new t;return e.name=this.name,e.type=this.type,e.validators=w(this.validators),e},t}();var m=function(){function t(){this.messages={CREATE_STEP_TITLE:"Ajouter une étape",EDIT_STEP_TITLE:"Modification de l'étape",ADD_STEP_BTN_TXT:"Ajouter une étape",FIRST_STEP_TXT:"Début",LAST_STEP_TXT:"Fin"},this.activeOptions={startIconClass:"far fa-flag",endIconClass:"fas fa-flag-checkered",editorGlobalLayoutClass:"ls-workflow-editor-default-layout",additionalFinalEndpointClasses:""},this.endpointIsEditable=!1,this.workflowChange=new e.EventEmitter}return Object.defineProperty(t.prototype,"localizedMessages",{get:function(){return this.messages},set:function(t){this.messages=Object.assign(this.messages,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.activeOptions},set:function(t){this.activeOptions=Object.assign(this.activeOptions,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"workflow",{get:function(){return this.workflowData},set:function(t){this.workflowData=t,this.workflowChange.emit(t)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){if(this.workflowData||(console.error("Missing input workflow data"),this.workflowData=new a),!this.messages)throw new Error("Missing localised messages for LsWorkflowViewerComponent!")},t.prototype.workflowDataChanged=function(){this.workflowChange.emit(this.workflowData)},t.prototype.askForStepDeletion=function(t){var e=this;console.debug("delete step"),this.confirmStepDeletionFct?this.confirmStepDeletionFct(this.workflowData.steps[t]).then((function(o){o&&e.deleteStep(t)})):this.deleteStep(t)},t.prototype.confirmStepCreation=function(t,e){this.addStep(t,e),this.closeCurrentPopover()},t.prototype.confirmStepEdition=function(t,e){this.replaceStep(t,e),this.closeCurrentPopover()},t.prototype.confirmFinalStepEdition=function(){this.closeCurrentPopover()},t.prototype.cancelStepEdition=function(){this.closeCurrentPopover()},t.prototype.cancelStepCreation=function(t){this.closeCurrentPopover()},t.prototype.isFirstStep=function(){return!this.workflowData||0===this.workflowData.steps.length},t.prototype.getAdditionalStepClass=function(t){return null!==this.currentEditedStepIdx&&this.currentEditedStepIdx===t?"selected":""},t.prototype.getStepIconClass=function(t){return this.getStepIconClassFct?this.getStepIconClassFct(t):""},t.prototype.getStepTooltip=function(t){return this.getStepTooltipFct?this.getStepTooltipFct(t):""},t.prototype.cloneStep=function(t){return t.clone()},t.prototype.createStep=function(t){var e=this,o=new f;this.currentPopover=this.getCreationPopoverForIdx(t),this.currentPopover.hidden.subscribe((function(){return e.cancelStepCreation(t)})),this.currentPopover.open({stepData:o,idx:t,cancelStepCreation:this.cancelStepCreation.bind(this),confirmStepCreation:this.confirmStepCreation.bind(this)})},t.prototype.editStep=function(t){var e=this;this.currentEditedStepIdx=t;var o=this.cloneStep(this.workflowData.steps[t]);this.currentPopover=this.getEditionPopoverForIdx(t),this.currentPopover.hidden.subscribe((function(){return e.cancelStepEdition()})),this.currentPopover.open({stepData:o,idx:t,cancelStepEdition:this.cancelStepEdition.bind(this),confirmStepEdition:this.confirmStepEdition.bind(this)})},t.prototype.editFinalStep=function(){var t=this,e=this.cloneStep(this.lastStepData);this.currentPopover=this.endpointPopoverElementRef,this.currentPopover.hidden.subscribe((function(){return t.cancelStepEdition()})),this.currentPopover.open({stepData:e,cancelStepEdition:this.cancelStepEdition.bind(this),confirmStepEdition:this.confirmFinalStepEdition.bind(this)})},t.prototype.drop=function(t){l.moveItemInArray(this.workflowData.steps,t.previousIndex,t.currentIndex),this.workflowDataChanged()},t.prototype.dragDisabledForIdx=function(t){return null!==this.currentEditedStepIdx&&this.currentEditedStepIdx===t},t.prototype.closeCurrentPopover=function(){this.currentPopover&&this.currentPopover.isOpen()&&this.currentPopover.close(),this.currentPopover=null,this.currentEditedStepIdx=null},t.prototype.addStep=function(t,e){this.workflowData.steps.splice(e,0,t),this.workflowDataChanged()},t.prototype.replaceStep=function(t,e){this.workflowData.steps.splice(e,1,t),this.workflowDataChanged()},t.prototype.deleteStep=function(t){this.workflowData.steps.splice(t,1),this.workflowDataChanged()},t.prototype.getCreationPopoverForIdx=function(t){return this.allCircuitEditionPopover.filter((function(t){var e=t._elementRef;return!e||!e.nativeElement||e.nativeElement.hasAttribute("create-btn")}))[t]},t.prototype.getEditionPopoverForIdx=function(t){return this.allCircuitEditionPopover.filter((function(t){var e=t._elementRef;return!e||!e.nativeElement||!e.nativeElement.hasAttribute("create-btn")}))[t]},t}();m.decorators=[{type:e.Component,args:[{selector:"ls-workflow-editor",template:'<div class="ls-workflow-editor" [ngClass]="options.editorGlobalLayoutClass">\n  <div class="ls-workflow-canevas">\n    <div class="ls-workflow-start ls-workflow-endpoint">\n      <div class="ls-workflow-endpoint-content">\n        <div class="ls-workflow-endpoint-icn fa fa-2x" [ngClass]="options.startIconClass"></div>\n        <div class="ls-step-bounds-txt">{{messages.FIRST_STEP_TXT}}</div>\n      </div>\n    </div>\n    <div class="ls-workflow-stepList-container" cdkDropList (cdkDropListDropped)="drop($event)">\n      <div class="ls-workflow-link-container">\n        <div class="ls-workflow-link"></div>\n        <div [ngClass]="isFirstStep() ? \'firstStep\' : \'\'" class="ls-link-button-container">\n          <div (click)="createStep(0)" [autoClose]="\'outside\'" [ngbPopover]="popCreateContent"\n               [popoverTitle]="messages.popCreateTitle" class="add-step-btn" create-btn\n               placement="right" popoverClass="ls-step-edition-popover"\n               triggers="manual"\n               autoClose="false">\n            <span class="fa fa-plus-circle"></span>\n            <span class="add-step-btn-txt">{{messages.ADD_STEP_BTN_TXT}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div *ngFor="let step of workflowData.steps; index as i">\n        <div class="ls-workflow-step-container" cdkDrag [cdkDragDisabled]="dragDisabledForIdx(i)">\n          <div [ngClass]="getAdditionalStepClass(i)" class="ls-workflow-step">\n            <div class="ls-step-top-line">\n              <div class="step-number">{{i + 1}}.</div>\n              <div class="step-name">{{step.name}}</div>\n              <div [ngClass]="getStepIconClass(step)" class="step-icn fa" ngbTooltip="{{getStepTooltip(step)}}"></div>\n            </div>\n            <div class="ls-step-validator-list">\n              <ng-template\n                [ngTemplateOutlet]="stepDisplayContentRef"\n                [ngTemplateOutletContext]="{step: step}">\n              </ng-template>\n            </div>\n          </div>\n          <div class="ls-workflow-step-external-buttons">\n            <div (click)="editStep(i)" [autoClose]="\'outside\'" [ngbPopover]="popEditContent"\n                 [popoverTitle]="messages.popEditTitle" class="fa fa-pencil-alt fa-pencil edit-step-btn"\n                 placement="right-top"\n                 popoverClass="ls-step-edition-popover"\n                 triggers="manual"></div>\n            <div (click)="askForStepDeletion(i)" class="fa fa-trash delete-step-btn"></div>\n          </div>\n        </div>\n\n        <div class="ls-workflow-link-container">\n          <div class="ls-workflow-link"></div>\n          <div class="ls-link-button-container">\n            <div (click)="createStep(i + 1)" [autoClose]="\'outside\'" [ngbPopover]="popCreateContent"\n                 [popoverTitle]="messages.popCreateTitle" class="add-step-btn" create-btn\n                 placement="right" popoverClass="ls-step-edition-popover"\n                 triggers="manual"\n                 autoClose="false">\n              <span class="fa fa-plus-circle"></span>\n              <span class="add-step-btn-txt">{{messages.ADD_STEP_BTN_TXT}}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n    <div class="ls-workflow-end ls-workflow-endpoint" [ngClass]="options.additionalFinalEndpointClasses">\n      <ng-container *ngIf="endpointIsEditable">\n        <div\n          #endpointPopoverHandle\n          (click)="editFinalStep()"\n          [autoClose]="\'outside\'"\n          [ngbPopover]="popEditFinalStepContent"\n          [popoverTitle]="messages.popEditTitle"\n          class="ls-workflow-endpoint-overlay"\n          placement="right"\n          popoverClass="ls-step-edition-popover"\n          triggers="manual">\n\n        </div>\n      </ng-container>\n      <div class="ls-workflow-endpoint-content">\n        <div class="ls-workflow-endpoint-icn-group">\n          <div class="ls-workflow-endpoint-icn fa fa-2x" [ngClass]="options.endIconClass"></div>\n          <div class="ls-step-bounds-txt">{{messages.LAST_STEP_TXT}}</div>\n        </div>\n        <div *ngIf="endpointIsEditable" class="ls-step-validator-list">\n          <ng-template [ngTemplateOutlet]="lastStepDisplayContentRef">\n          </ng-template>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n<ng-template\n  #popEditContent\n  let-idx="idx"\n  let-stepData="stepData"\n  let-cancelStepEdition="cancelStepEdition"\n  let-confirmStepEdition="confirmStepEdition">\n  <ng-template\n    [ngTemplateOutlet]="popEditContentTemplateRef"\n    [ngTemplateOutletContext]="{idx:idx, stepData:stepData, cancelStepEdition:cancelStepEdition, confirmStepEdition:confirmStepEdition}">\n  </ng-template>\n</ng-template>\n\n<ng-template\n  #popCreateContent\n  let-idx="idx"\n  let-stepData="stepData"\n  let-cancelStepCreation="cancelStepCreation"\n  let-confirmStepCreation="confirmStepCreation">\n  <ng-template\n    [ngTemplateOutlet]="popCreateContentTemplateRef"\n    [ngTemplateOutletContext]="{idx:idx, stepData:stepData, cancelStepCreation:cancelStepCreation, confirmStepCreation:confirmStepCreation}">\n  </ng-template>\n</ng-template>\n\n\n<ng-template\n  #popEditFinalStepContent\n  let-stepData="stepData"\n  let-cancelStepEdition="cancelStepEdition"\n  let-confirmStepEdition="confirmStepEdition">\n  <ng-template\n    [ngTemplateOutlet]="endpointPopoverEditContentRef"\n    [ngTemplateOutletContext]="{stepData:stepData, cancelStepEdition:cancelStepEdition, confirmStepEdition:confirmStepEdition, isLastStep:true}">\n  </ng-template>\n</ng-template>\n',styles:['body{background-color:var(--ls-grey-50)}.active-btn{color:#42a1e8}.ls-workflow-canevas{-ms-flex-align:center;-ms-flex-direction:column;-ms-flex-pack:start;-ms-grid-column:1;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:vertical;-webkit-box-pack:start;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:column;grid-column:1;height:100%;justify-content:flex-start}.ls-workflow-endpoint.with-content,.ls-workflow-step{-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);background-color:#fff;border:none;box-shadow:0 0 .25rem rgba(0,0,0,.15);min-height:6rem;width:var(--ls-workflow-step-width,20rem)}.ls-workflow-endpoint.with-content .ls-step-top-line,.ls-workflow-step .ls-step-top-line{-ms-flex-align:center;-ms-flex-direction:row;-ms-flex-pack:justify;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:justify;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;font-weight:700;justify-content:space-between;padding:.5rem}.ls-workflow-endpoint.with-content .ls-display-step-separator,.ls-workflow-step .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-endpoint.with-content .ls-step-validator-list,.ls-workflow-step .ls-step-validator-list{color:#5b5b5b;padding:.5rem .5rem .5rem 1.5rem}.ls-workflow-step.selected,.selected.ls-workflow-endpoint.with-content{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.ls-workflow-endpoint.with-content .step-icn,.ls-workflow-step .step-icn{height:1.7rem;width:1.7rem}.ls-workflow-endpoint-content{margin:auto;text-align:center}.ls-workflow-endpoint-content .ls-step-bounds-txt{color:var(--primary);font-weight:700}.ls-workflow-endpoint-content .ls-workflow-endpoint-icn{color:var(--primary)}.ls-workflow-endpoint-content.not-active .ls-step-bounds-txt,.ls-workflow-endpoint-content.not-active .ls-workflow-endpoint-icn{color:#5b5b5b}.ls-workflow-endpoint-content .ls-step-validator-list{text-align:left}.ls-horizontal-separation-line{border-bottom:1px solid #5b5b5b;margin-top:2rem}.ls-workflow-endpoint{-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);background-color:#fff;border:none;border-radius:50%;box-shadow:0 0 .25rem rgba(0,0,0,.15);display:-ms-grid;display:grid;height:6rem;position:relative;width:6rem}.ls-workflow-endpoint.with-content{border-radius:0;display:block;width:var(--ls-workflow-step-width,20rem)}.ls-workflow-endpoint.with-content .ls-workflow-endpoint-content{height:100%;padding:.5em;width:100%}.ls-workflow-endpoint.with-content .ls-workflow-endpoint-content .ls-workflow-endpoint-icn-group{-ms-flex-align:baseline;-ms-flex-direction:row-reverse;-ms-flex-pack:justify;-webkit-box-align:baseline;-webkit-box-direction:reverse;-webkit-box-orient:horizontal;-webkit-box-pack:justify;align-items:baseline;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row-reverse;justify-content:space-between;padding:0 .5em;width:100%}.ls-workflow-endpoint.with-content .ls-workflow-endpoint-content .ls-workflow-endpoint-icn-group:after{content:"";display:block;width:2em}.ls-workflow-endpoint .ls-workflow-endpoint-overlay{bottom:0;cursor:pointer;height:100%;left:0;position:absolute;width:100%;z-index:2}.ls-workflow-link{border:1px solid #222;width:0}.cdk-drag-preview .ls-workflow-endpoint.with-content,.cdk-drag-preview .ls-workflow-step{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.cdk-drag-placeholder{min-height:6rem}.cdk-drag-placeholder .ls-workflow-endpoint.with-content,.cdk-drag-placeholder .ls-workflow-step,.cdk-drag-placeholder .ls-workflow-step-external-buttons{display:none}.cdk-drop-list-dragging .cdk-drag{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-animating{-webkit-transition:-webkit-transform .3s cubic-bezier(0,0,.2,1);transition:-webkit-transform .3s cubic-bezier(0,0,.2,1);transition:transform .3s cubic-bezier(0,0,.2,1);transition:transform .3s cubic-bezier(0,0,.2,1),-webkit-transform .3s cubic-bezier(0,0,.2,1)}.ls-workflow-link-container{-ms-flex-direction:row;-webkit-box-direction:normal;-webkit-box-orient:horizontal;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;min-height:4rem;min-width:20rem}.ls-workflow-link-container:before{-ms-flex:0 0 calc(50% - 2px);-webkit-box-flex:0;content:"";flex:0 0 calc(50% - 2px)}.ls-workflow-link-container .ls-link-button-container{-ms-flex:0 0 calc(50% - 2px);-ms-flex-item-align:center;-ms-grid-row-align:center;-webkit-box-flex:0;align-self:center;flex:0 0 calc(50% - 2px);height:-webkit-min-content;height:-moz-min-content;height:min-content;padding-left:1rem;width:-webkit-min-content;width:-moz-min-content;width:min-content}.ls-workflow-stepList-container{width:100%}.ls-workflow-step-container{-ms-flex-direction:row;-ms-flex-item-align:center;-ms-flex-pack:center;-ms-grid-row-align:center;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:center;align-self:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;justify-content:center;margin-left:auto;margin-right:auto}.ls-workflow-step-container:before{-ms-flex:0 0 5rem;-webkit-box-flex:0;content:"";flex:0 0 5rem}.ls-workflow-step-container .ls-workflow-endpoint.with-content,.ls-workflow-step-container .ls-workflow-step{-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center}.ls-workflow-step-container .ls-workflow-step-external-buttons{-ms-flex:0 0 5rem;-webkit-box-flex:0;flex:0 0 5rem;height:-webkit-min-content;height:-moz-min-content;height:min-content;padding-left:1rem}.ls-workflow-step-external-buttons{-ms-flex-direction:row;-ms-flex-pack:start;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:start;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;justify-content:flex-start}.ls-workflow-step-external-buttons .edit-step-btn{cursor:pointer;margin-right:1rem}.ls-workflow-step-external-buttons .edit-step-btn:hover{color:var(--primary)}.ls-workflow-step-external-buttons .delete-step-btn{cursor:pointer}.ls-workflow-step-external-buttons .delete-step-btn:hover{color:var(--danger)}.ls-workflow-editor{display:-ms-grid;display:grid;height:100%}.ls-workflow-editor .ls-link-button-container .add-step-btn{cursor:pointer;width:-webkit-max-content;width:-moz-max-content;width:max-content}.ls-workflow-editor .ls-link-button-container .add-step-btn .add-step-btn-txt{-webkit-transition:opacity .2s ease-in-out;margin-left:.5em;opacity:0;transition:opacity .2s ease-in-out}.ls-workflow-editor .ls-link-button-container.firstStep .add-step-btn .add-step-btn-txt,.ls-workflow-editor .ls-link-button-container:hover .add-step-btn .add-step-btn-txt{opacity:1}.ls-workflow-editor-default-layout{-ms-grid-columns:66% auto;-ms-grid-rows:100%;grid-template-columns:66% auto;grid-template-rows:100%}@media (min-width:1400px){.container{max-width:1340px}}@media (min-width:1600px){.container{max-width:1540px}}']}]}],m.ctorParameters=function(){return[]},m.propDecorators={endpointPopoverElementRef:[{type:e.ViewChild,args:["endpointPopoverHandle",{read:i.NgbPopover}]}],allCircuitEditionPopover:[{type:e.ViewChildren,args:[i.NgbPopover]}],popEditContentTemplateRef:[{type:e.ContentChild,args:["popEditContent"]}],popCreateContentTemplateRef:[{type:e.ContentChild,args:["popCreateContent"]}],endpointPopoverEditContentRef:[{type:e.ContentChild,args:["endpointPopoverEditContent"]}],stepDisplayContentRef:[{type:e.ContentChild,args:["stepDisplayContent"]}],lastStepDisplayContentRef:[{type:e.ContentChild,args:["lastStepDisplayContent"]}],endpointIsEditable:[{type:e.Input}],getStepIconClassFct:[{type:e.Input}],getStepTooltipFct:[{type:e.Input}],confirmStepDeletionFct:[{type:e.Input}],lastStepData:[{type:e.Input}],workflowChange:[{type:e.Output}],localizedMessages:[{type:e.Input}],options:[{type:e.Input}],workflow:[{type:e.Input}]};var g=function(t){this.currentStepIdx=0,this.rejected=!1,this.isOver=!1,this.id=t.id,this.name=t.name,this.description=t.description,this.rejected=t.isRejected,this.isOver=t.isOver,t.steps&&(this.steps=t.steps,this.currentStepIdx=t.steps.findIndex((function(t){return t.state===p.CURRENT})),-1===this.currentStepIdx&&(this.currentStepIdx=0))};var u=function(){function t(){this.messages={FIRST_STEP_TXT:"Start",LAST_STEP_TXT:"End"},this.reducedMode=!0,this.isOver=!1,this.isRejected=!1,this._options={startIconClass:"far fa-flag",endIconClass:"fas fa-flag-checkered",validatedIconClass:"fas fa-check",rejectedIconClass:"fas fa-times",hideStart:!1}}return Object.defineProperty(t.prototype,"options",{get:function(){return this._options},set:function(t){this._options=Object.assign(this._options,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localizedMessages",{get:function(){return this.messages},set:function(t){this.messages=Object.assign(this.messages,t)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){if(console.warn("instanciating ls workflow instance viewer!"),this.workflowData||(console.error("Missing input circuit data"),this.workflowData=new g),!this.messages)throw new Error("Missing localised messages for LsWorkflowViewerComponent!");if(!this.getStepIconClassFct)throw new Error("Missing getStepIconClassFct for LsWorkflowViewerComponent!");if(!this.getStepTooltipFct)throw new Error("Missing getStepTooltipFct for LsWorkflowViewerComponent!")},t.prototype.ngOnChanges=function(){console.debug("LsWorkflowViewerComponent::ngOnChanges, ",this),this.activeStep=this.workflowData.currentStepIdx,this.isOver=this.workflowData.isOver,this.isRejected=this.workflowData.rejected},t.prototype.getStepIconClass=function(t){return this.getStepIconClassFct(t)},t.prototype.getStepTooltip=function(t){return this.getStepTooltipFct(t)},t.prototype.isActiveStep=function(t){return!this.isRejected&&!this.isOver&&t===this.activeStep},t.prototype.isPassed=function(t){return t.state===p.VALIDATED||t.state===p.REJECTED},t.prototype.isActualValidator=function(t,e){return t.validatedBy.some((function(t){return t.id===e.id}))},t.prototype.isCircuitOver=function(){return this.isOver&&!this.isRejected},t.prototype.getCircuitEndAdditionalClasses=function(){var t=[];return this.getCircuitEndAdditionalClassesFct?t.push(this.getCircuitEndAdditionalClassesFct()):t.push(this._options.additionalFinalEndpointClasses||""),this.reducedMode&&t.push("reduced-end-step"),t},t.prototype.getAdditionalValidatorListClasses=function(){},t.prototype.getStepAdditionalClasses=function(t,e){var o=[];return this.isActiveStep(e)&&o.push("ls-active-step ls-white-icn"),this.reducedMode&&o.push("ls-reduced-step"),this.reducedMode||t.state===p.SKIPPED&&o.push("wa-circuit-skipped-step"),t.state===p.VALIDATED&&o.push("ls-validated-step"),o},t.prototype.getValidatorClasses=function(t,e){return this.isActualValidator(t,e)?t.state===p.REJECTED?this.options.rejectedIconClass:this.options.validatedIconClass:""},t}();u.decorators=[{type:e.Component,args:[{selector:"ls-workflow-instance-viewer",template:'<div class="ls-workflow-display">\n  <div class="ls-workflow-canevas">\n    <div class="circuit-start">\n      <div *ngIf="!options.hideStart" class="ls-workflow-endpoint-content">\n        <span class="ls-workflow-endpoint-icn fa fa fa-2x" [ngClass]="options.startIconClass"></span>\n        <span class="ls-step-bounds-txt" [innerText]="messages.FIRST_STEP_TXT"></span>\n      </div>\n    </div>\n    <div class="steps-container">\n      <div *ngFor="let step of workflowData.steps; index as i">\n        <div class="ls-workflow-display-step-container">\n          <div class="ls-workflow-step" [ngClass]="getStepAdditionalClasses(step, i)">\n            <div class="ls-step-top-line">\n              <div class="step-number">{{i + 1}}.</div>\n              <div class="step-name">{{step.name}}</div>\n              <div [ngClass]="getStepIconClass(step)" class="step-icn fa" ngbTooltip="{{getStepTooltip(step)}}"></div>\n            </div>\n            <div class="ls-display-step-separator"></div>\n            <div class="ls-step-validator-list" [ngClass]="getAdditionalValidatorListClasses">\n              <ng-container *ngIf="isPassed(step)">\n                <div *ngFor="let validator of step.validators">\n                  <ng-template\n                    [ngTemplateOutlet]="passedStepTemplateRef"\n                    [ngTemplateOutletContext]="{step: step, validator: validator}">\n                  </ng-template>\n                </div>\n              </ng-container>\n              <ng-container *ngIf=" ! isPassed(step)">\n                <div *ngFor="let validator of step.validators" class="ls-step-validator">\n                  <ng-template\n                    [ngTemplateOutlet]="pendingStepTemplateRef"\n                    [ngTemplateOutletContext]="{step: step, validator: validator}">\n                  </ng-template>\n                </div>\n              </ng-container>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="ls-workflow-end" [ngClass]="getCircuitEndAdditionalClasses()">\n      <div class="ls-workflow-endpoint-content">\n        <span class="ls-workflow-endpoint-icn fa fa-2x" [ngClass]="options.endIconClass"></span>\n        <span class="ls-step-bounds-txt" [innerText]="messages.LAST_STEP_TXT"></span>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:['@charset "UTF-8";body{background-color:var(--ls-grey-50)}.active-btn{color:#42a1e8}.ls-workflow-canevas{-ms-flex-align:center;-ms-flex-direction:column;-ms-flex-pack:start;-ms-grid-column:1;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:vertical;-webkit-box-pack:start;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:column;grid-column:1;height:100%;justify-content:flex-start}.ls-workflow-step{-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);background-color:#fff;border:none;box-shadow:0 0 .25rem rgba(0,0,0,.15);min-height:6rem;width:var(--ls-workflow-step-width,20rem)}.ls-workflow-step .ls-step-top-line{-ms-flex-align:center;-ms-flex-direction:row;-ms-flex-pack:justify;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:justify;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;font-weight:700;justify-content:space-between;padding:.5rem}.ls-workflow-step .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-step .ls-step-validator-list{color:#5b5b5b;padding:.5rem .5rem .5rem 1.5rem}.ls-workflow-step.selected{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.ls-workflow-step .step-icn{height:1.7rem;width:1.7rem}.ls-workflow-endpoint-content{margin:auto;text-align:center}.ls-workflow-endpoint-content .ls-step-bounds-txt{color:var(--primary);font-weight:700}.ls-workflow-endpoint-content .ls-workflow-endpoint-icn{color:var(--primary)}.ls-workflow-endpoint-content.not-active .ls-step-bounds-txt,.ls-workflow-endpoint-content.not-active .ls-workflow-endpoint-icn{color:#5b5b5b}.ls-workflow-endpoint-content .ls-step-validator-list{text-align:left}.ls-actual-validator{font-weight:700}.ls-actual-validator:before{color:var(--primary);content:"";font-family:var(--ls-font-awesome-family,"Font Awesome 5 Free");font-size:1em;left:.5em;position:absolute}.ls-rejector{font-weight:700}.ls-rejector:before{color:var(--danger);content:"";font-family:var(--ls-font-awesome-family,"Font Awesome 5 Free");font-size:1em;left:.5em;position:absolute}.wa-comment-icon{color:var(--primary);font-size:1em;margin-right:.5em}.ls-workflow-display .ls-workflow-step{margin:1rem auto;padding-left:0;padding-right:0}.ls-workflow-display .ls-workflow-step .ls-step-validator-list{padding:1rem 1rem 1rem .5rem}.ls-workflow-display .ls-workflow-step .ls-step-validator-list.ls-workflow-instance{padding-left:2rem}.ls-workflow-display .ls-workflow-step.ls-reduced-step{-ms-grid-columns:(1fr)[12];-ms-grid-rows:2em auto;-webkit-box-shadow:none;background-color:transparent;border:none;box-shadow:none;display:-ms-grid;display:grid;grid-row-gap:.5em;grid-template-columns:repeat(12,1fr);grid-template-rows:2em auto;min-height:unset;width:var(--ls-workflow-reduced-step-width,16rem)}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line{align-items:center;display:grid;grid-column:1/-1;grid-row:1;grid-template-columns:1fr 2fr 9fr;grid-template-rows:1fr;justify-content:center;padding:0}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line .step-number{display:none}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line .step-icn{-ms-grid-column:2;-ms-grid-row:1;font-size:24px;grid-column:2;grid-row:1;height:unset;margin:auto;width:unset}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line .step-name{-ms-grid-column:3;-ms-grid-row:1;grid-column:3;grid-row:1}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-display-step-separator{-ms-grid-column:3;-ms-grid-row:2;border-bottom:0;border-left:1px solid #d3d3d3;grid-column:3;grid-row:2}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-validator-list{-ms-grid-row:2;color:#d3d3d3;font-size:.8rem;font-style:italic;grid-column:4/-1;grid-row:2;padding:.5em}.ls-workflow-display .ls-workflow-step.ls-reduced-step.ls-validated-step .ls-step-top-line,.ls-workflow-display .ls-workflow-step.ls-reduced-step.ls-validated-step .ls-step-top-line .step-icn.test-icon-class,.ls-workflow-display .ls-workflow-step.ls-reduced-step.ls-validated-step .ls-step-top-line .step-icn.test-icon-class:before{color:#23a237}.ls-workflow-display .reduced-end-step .ls-workflow-endpoint-content .ls-step-bounds-txt{margin-left:1em}.ls-workflow-display .ls-workflow-endpoint-content{-ms-flex-direction:row;-webkit-box-direction:normal;-webkit-box-orient:horizontal;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row}.ls-workflow-display .ls-workflow-endpoint-content .ls-step-bounds-txt{margin-left:.5rem}.ls-workflow-display .ls-step-top-line{-ms-flex-pack:start;-webkit-box-pack:start;justify-content:flex-start;padding-left:.5rem}.ls-workflow-display .ls-step-top-line .step-name{-ms-flex:1;-webkit-box-flex:1;flex:1;margin-left:.7rem}.ls-workflow-display .ls-workflow-display-step-container{position:relative}.ls-workflow-display .ls-active-step:not(.ls-reduced-step) .ls-step-top-line{background-color:var(--primary);color:#fff;margin:0}.ls-workflow-display .ls-active-step:not(.ls-reduced-step) .ls-step-top-line .step-icn{color:#fff}.ls-workflow-display .ls-active-step:before{color:var(--ls-workflow-arrow-color,var(--primary));content:"";font-family:var(--ls-font-awesome-family,"Font Awesome 5 Free");font-size:2em;font-style:normal;font-variant:normal;font-weight:900;left:-1em;line-height:1;position:absolute;text-rendering:auto}.ls-workflow-display .ls-active-step.end-step:before{font-size:1.2em}.ls-workflow-end{position:relative}']}]}],u.ctorParameters=function(){return[]},u.propDecorators={passedStepTemplateRef:[{type:e.ContentChild,args:["passedStepContent"]}],pendingStepTemplateRef:[{type:e.ContentChild,args:["pendingStepContent"]}],workflowData:[{type:e.Input,args:["src"]}],activeStep:[{type:e.Input}],getStepIconClassFct:[{type:e.Input}],getStepTooltipFct:[{type:e.Input}],getCircuitEndAdditionalClassesFct:[{type:e.Input}],reducedMode:[{type:e.Input}],options:[{type:e.Input}],localizedMessages:[{type:e.Input}]};var b=function(){};b.decorators=[{type:e.NgModule,args:[{declarations:[m,d,u],imports:[r.BrowserModule,s.CommonModule,o.BrowserAnimationsModule,n.FormsModule,i.NgbModule,l.DragDropModule],exports:[m,d,u]}]}],b.ctorParameters=function(){return[]};var k=function(t){this.validatedBy=[],this.id=t.id,this.name=t.name,this.validators=t.validators?w(t.validators):[],this.state=t.state,this.validatedBy=t.actedUponBy?[t.actedUponBy]:[],this.comment=t.comment,t.actionId&&(this.id=t.actionId)};var h=function(){};var v=function(){};var x=function(){};t.LsWorkflowEditorComponent=m,t.LsWorkflowInstanceViewerComponent=u,t.LsWorkflowModelViewerComponent=d,t.LsWorkflowsModule=b,t.StepInstance=k,t.StepModel=f,t.StepState=p,t.WorkflowActor=h,t.WorkflowInstance=g,t.WorkflowModel=a,t.WorkflowModelLocalizedMessages=x,t.WorkflowModelOptions=v,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=libriciel-ls-composants-workflows.umd.min.js.map