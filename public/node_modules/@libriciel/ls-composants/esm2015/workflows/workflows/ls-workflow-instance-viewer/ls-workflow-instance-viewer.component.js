/**
 * @fileoverview added by tsickle
 * Generated from: workflows/ls-workflow-instance-viewer/ls-workflow-instance-viewer.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ContentChild, Input } from '@angular/core';
import { WorkflowInstance } from '../../shared/model/workflows/workflow-instance';
import { StepState } from '../../shared/model/workflows/step-state';
import { WorkflowInstanceLocalizedMessages, WorkflowInstanceOptions } from '../../shared/model/workflows/workflow-instance-option';
export class LsWorkflowInstanceViewerComponent {
    constructor() {
        this.messages = {
            FIRST_STEP_TXT: 'Start',
            LAST_STEP_TXT: 'End'
        };
        this.reducedMode = true;
        this.isOver = false;
        this.isRejected = false;
        this._options = {
            startIconClass: 'far fa-flag',
            endIconClass: 'fas fa-flag-checkered',
            validatedIconClass: 'fas fa-check',
            rejectedIconClass: 'fas fa-times',
            hideStart: false
        };
    }
    /**
     * @return {?}
     */
    get options() {
        return this._options;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set options(value) {
        this._options = Object.assign(this._options, value);
    }
    /**
     * @return {?}
     */
    get localizedMessages() {
        return this.messages;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set localizedMessages(value) {
        this.messages = Object.assign(this.messages, value);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        console.warn('instanciating ls workflow instance viewer!');
        if (!this.workflowData) {
            console.error('Missing input circuit data');
            this.workflowData = new WorkflowInstance();
        }
        if (!this.messages) {
            throw new Error('Missing localised messages for LsWorkflowViewerComponent!');
        }
        if (!this.getStepIconClassFct) {
            throw new Error('Missing getStepIconClassFct for LsWorkflowViewerComponent!');
        }
        if (!this.getStepTooltipFct) {
            throw new Error('Missing getStepTooltipFct for LsWorkflowViewerComponent!');
        }
    }
    /**
     * @return {?}
     */
    ngOnChanges() {
        console.debug('LsWorkflowViewerComponent::ngOnChanges, ', this);
        this.activeStep = this.workflowData.currentStepIdx;
        this.isOver = this.workflowData.isOver;
        this.isRejected = this.workflowData.rejected;
    }
    /**
     * @param {?} step
     * @return {?}
     */
    getStepIconClass(step) {
        return this.getStepIconClassFct(step);
    }
    /**
     * @param {?} step
     * @return {?}
     */
    getStepTooltip(step) {
        return this.getStepTooltipFct(step);
    }
    /**
     * @param {?} stepIdx
     * @return {?}
     */
    isActiveStep(stepIdx) {
        return !this.isRejected && !this.isOver && stepIdx === this.activeStep;
    }
    /**
     * @param {?} step
     * @return {?}
     */
    isPassed(step) {
        return (step.state === StepState.VALIDATED) || (step.state === StepState.REJECTED);
    }
    /**
     * @param {?} step
     * @param {?} validator
     * @return {?}
     */
    isActualValidator(step, validator) {
        return step.validatedBy.some((/**
         * @param {?} elem
         * @return {?}
         */
        (elem) => elem.id === validator.id));
    }
    /**
     * @return {?}
     */
    isCircuitOver() {
        return this.isOver && !this.isRejected;
    }
    /**
     * @return {?}
     */
    getCircuitEndAdditionalClasses() {
        /** @type {?} */
        const classes = [];
        if (this.getCircuitEndAdditionalClassesFct) {
            classes.push(this.getCircuitEndAdditionalClassesFct());
        }
        else {
            classes.push(this._options.additionalFinalEndpointClasses || '');
        }
        if (this.reducedMode) {
            classes.push('reduced-end-step');
        }
        return classes;
    }
    /**
     * @return {?}
     */
    getAdditionalValidatorListClasses() {
        //wa-circuit-instance
    }
    /**
     * @param {?} step
     * @param {?} stepIdx
     * @return {?}
     */
    getStepAdditionalClasses(step, stepIdx) {
        // this.isActiveStep(stepIdx) ? 'wa-active-step wa-white-icn' : ''
        /** @type {?} */
        const classes = [];
        if (this.isActiveStep(stepIdx)) {
            classes.push('ls-active-step ls-white-icn');
        }
        if (this.reducedMode) {
            classes.push('ls-reduced-step');
        }
        if (!this.reducedMode) {
            if (step.state === StepState.SKIPPED) {
                classes.push('wa-circuit-skipped-step');
            }
        }
        if (step.state === StepState.VALIDATED) {
            classes.push('ls-validated-step');
        }
        return classes;
    }
    /**
     * @param {?} step
     * @param {?} validator
     * @return {?}
     */
    getValidatorClasses(step, validator) {
        if (this.isActualValidator(step, validator)) {
            if (step.state === StepState.REJECTED) {
                return this.options.rejectedIconClass;
            }
            else {
                return this.options.validatedIconClass;
            }
        }
        return '';
    }
}
LsWorkflowInstanceViewerComponent.decorators = [
    { type: Component, args: [{
                selector: 'ls-workflow-instance-viewer',
                template: "<div class=\"ls-workflow-display\">\n  <div class=\"ls-workflow-canevas\">\n    <div class=\"circuit-start\">\n      <div *ngIf=\"!options.hideStart\" class=\"ls-workflow-endpoint-content\">\n        <span class=\"ls-workflow-endpoint-icn fa fa fa-2x\" [ngClass]=\"options.startIconClass\"></span>\n        <span class=\"ls-step-bounds-txt\" [innerText]=\"messages.FIRST_STEP_TXT\"></span>\n      </div>\n    </div>\n    <div class=\"steps-container\">\n      <div *ngFor=\"let step of workflowData.steps; index as i\">\n        <div class=\"ls-workflow-display-step-container\">\n          <div class=\"ls-workflow-step\" [ngClass]=\"getStepAdditionalClasses(step, i)\">\n            <div class=\"ls-step-top-line\">\n              <div class=\"step-number\">{{i + 1}}.</div>\n              <div class=\"step-name\">{{step.name}}</div>\n              <div [ngClass]=\"getStepIconClass(step)\" class=\"step-icn fa\" ngbTooltip=\"{{getStepTooltip(step)}}\"></div>\n            </div>\n            <div class=\"ls-display-step-separator\"></div>\n            <div class=\"ls-step-validator-list\" [ngClass]=\"getAdditionalValidatorListClasses\">\n              <ng-container *ngIf=\"isPassed(step)\">\n                <div *ngFor=\"let validator of step.validators\">\n                  <ng-template\n                    [ngTemplateOutlet]=\"passedStepTemplateRef\"\n                    [ngTemplateOutletContext]=\"{step: step, validator: validator}\">\n                  </ng-template>\n                </div>\n              </ng-container>\n              <ng-container *ngIf=\" ! isPassed(step)\">\n                <div *ngFor=\"let validator of step.validators\" class=\"ls-step-validator\">\n                  <ng-template\n                    [ngTemplateOutlet]=\"pendingStepTemplateRef\"\n                    [ngTemplateOutletContext]=\"{step: step, validator: validator}\">\n                  </ng-template>\n                </div>\n              </ng-container>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"ls-workflow-end\" [ngClass]=\"getCircuitEndAdditionalClasses()\">\n      <div class=\"ls-workflow-endpoint-content\">\n        <span class=\"ls-workflow-endpoint-icn fa fa-2x\" [ngClass]=\"options.endIconClass\"></span>\n        <span class=\"ls-step-bounds-txt\" [innerText]=\"messages.LAST_STEP_TXT\"></span>\n      </div>\n    </div>\n  </div>\n</div>\n",
                styles: ["@charset \"UTF-8\";body{background-color:var(--ls-grey-50)}.active-btn{color:#42a1e8}.ls-workflow-canevas{-ms-flex-align:center;-ms-flex-direction:column;-ms-flex-pack:start;-ms-grid-column:1;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:vertical;-webkit-box-pack:start;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:column;grid-column:1;height:100%;justify-content:flex-start}.ls-workflow-step{-webkit-box-shadow:0 0 .25rem rgba(0,0,0,.15);background-color:#fff;border:none;box-shadow:0 0 .25rem rgba(0,0,0,.15);min-height:6rem;width:var(--ls-workflow-step-width,20rem)}.ls-workflow-step .ls-step-top-line{-ms-flex-align:center;-ms-flex-direction:row;-ms-flex-pack:justify;-webkit-box-align:center;-webkit-box-direction:normal;-webkit-box-orient:horizontal;-webkit-box-pack:justify;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row;font-weight:700;justify-content:space-between;padding:.5rem}.ls-workflow-step .ls-display-step-separator{border-bottom:1px solid #d3d3d3;width:100%}.ls-workflow-step .ls-step-validator-list{color:#5b5b5b;padding:.5rem .5rem .5rem 1.5rem}.ls-workflow-step.selected{-webkit-box-shadow:0 .5rem .25rem rgba(0,0,0,.3);box-shadow:0 .5rem .25rem rgba(0,0,0,.3)}.ls-workflow-step .step-icn{height:1.7rem;width:1.7rem}.ls-workflow-endpoint-content{margin:auto;text-align:center}.ls-workflow-endpoint-content .ls-step-bounds-txt{color:var(--primary);font-weight:700}.ls-workflow-endpoint-content .ls-workflow-endpoint-icn{color:var(--primary)}.ls-workflow-endpoint-content.not-active .ls-step-bounds-txt,.ls-workflow-endpoint-content.not-active .ls-workflow-endpoint-icn{color:#5b5b5b}.ls-workflow-endpoint-content .ls-step-validator-list{text-align:left}.ls-actual-validator{font-weight:700}.ls-actual-validator:before{color:var(--primary);content:\"\uF00C\";font-family:var(--ls-font-awesome-family,\"Font Awesome 5 Free\");font-size:1em;left:.5em;position:absolute}.ls-rejector{font-weight:700}.ls-rejector:before{color:var(--danger);content:\"\uF00D\";font-family:var(--ls-font-awesome-family,\"Font Awesome 5 Free\");font-size:1em;left:.5em;position:absolute}.wa-comment-icon{color:var(--primary);font-size:1em;margin-right:.5em}.ls-workflow-display .ls-workflow-step{margin:1rem auto;padding-left:0;padding-right:0}.ls-workflow-display .ls-workflow-step .ls-step-validator-list{padding:1rem 1rem 1rem .5rem}.ls-workflow-display .ls-workflow-step .ls-step-validator-list.ls-workflow-instance{padding-left:2rem}.ls-workflow-display .ls-workflow-step.ls-reduced-step{-ms-grid-columns:(1fr)[12];-ms-grid-rows:2em auto;-webkit-box-shadow:none;background-color:transparent;border:none;box-shadow:none;display:-ms-grid;display:grid;grid-row-gap:.5em;grid-template-columns:repeat(12,1fr);grid-template-rows:2em auto;min-height:unset;width:var(--ls-workflow-reduced-step-width,16rem)}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line{align-items:center;display:grid;grid-column:1/-1;grid-row:1;grid-template-columns:1fr 2fr 9fr;grid-template-rows:1fr;justify-content:center;padding:0}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line .step-number{display:none}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line .step-icn{-ms-grid-column:2;-ms-grid-row:1;font-size:24px;grid-column:2;grid-row:1;height:unset;margin:auto;width:unset}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-top-line .step-name{-ms-grid-column:3;-ms-grid-row:1;grid-column:3;grid-row:1}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-display-step-separator{-ms-grid-column:3;-ms-grid-row:2;border-bottom:0;border-left:1px solid #d3d3d3;grid-column:3;grid-row:2}.ls-workflow-display .ls-workflow-step.ls-reduced-step .ls-step-validator-list{-ms-grid-row:2;color:#d3d3d3;font-size:.8rem;font-style:italic;grid-column:4/-1;grid-row:2;padding:.5em}.ls-workflow-display .ls-workflow-step.ls-reduced-step.ls-validated-step .ls-step-top-line,.ls-workflow-display .ls-workflow-step.ls-reduced-step.ls-validated-step .ls-step-top-line .step-icn.test-icon-class,.ls-workflow-display .ls-workflow-step.ls-reduced-step.ls-validated-step .ls-step-top-line .step-icn.test-icon-class:before{color:#23a237}.ls-workflow-display .reduced-end-step .ls-workflow-endpoint-content .ls-step-bounds-txt{margin-left:1em}.ls-workflow-display .ls-workflow-endpoint-content{-ms-flex-direction:row;-webkit-box-direction:normal;-webkit-box-orient:horizontal;display:-webkit-box;display:-ms-flexbox;display:flex;flex-direction:row}.ls-workflow-display .ls-workflow-endpoint-content .ls-step-bounds-txt{margin-left:.5rem}.ls-workflow-display .ls-step-top-line{-ms-flex-pack:start;-webkit-box-pack:start;justify-content:flex-start;padding-left:.5rem}.ls-workflow-display .ls-step-top-line .step-name{-ms-flex:1;-webkit-box-flex:1;flex:1;margin-left:.7rem}.ls-workflow-display .ls-workflow-display-step-container{position:relative}.ls-workflow-display .ls-active-step:not(.ls-reduced-step) .ls-step-top-line{background-color:var(--primary);color:#fff;margin:0}.ls-workflow-display .ls-active-step:not(.ls-reduced-step) .ls-step-top-line .step-icn{color:#fff}.ls-workflow-display .ls-active-step:before{color:var(--ls-workflow-arrow-color,var(--primary));content:\"\uF061\";font-family:var(--ls-font-awesome-family,\"Font Awesome 5 Free\");font-size:2em;font-style:normal;font-variant:normal;font-weight:900;left:-1em;line-height:1;position:absolute;text-rendering:auto}.ls-workflow-display .ls-active-step.end-step:before{font-size:1.2em}.ls-workflow-end{position:relative}"]
            }] }
];
/** @nocollapse */
LsWorkflowInstanceViewerComponent.ctorParameters = () => [];
LsWorkflowInstanceViewerComponent.propDecorators = {
    passedStepTemplateRef: [{ type: ContentChild, args: ['passedStepContent',] }],
    pendingStepTemplateRef: [{ type: ContentChild, args: ['pendingStepContent',] }],
    workflowData: [{ type: Input, args: ['src',] }],
    activeStep: [{ type: Input }],
    getStepIconClassFct: [{ type: Input }],
    getStepTooltipFct: [{ type: Input }],
    getCircuitEndAdditionalClassesFct: [{ type: Input }],
    reducedMode: [{ type: Input }],
    options: [{ type: Input }],
    localizedMessages: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.passedStepTemplateRef;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.pendingStepTemplateRef;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.workflowData;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.activeStep;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.messages;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.getStepIconClassFct;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.getStepTooltipFct;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.getCircuitEndAdditionalClassesFct;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.reducedMode;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.isOver;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype.isRejected;
    /** @type {?} */
    LsWorkflowInstanceViewerComponent.prototype._options;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHMtd29ya2Zsb3ctaW5zdGFuY2Utdmlld2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIvYnVpbGRzL291dGlscy9jaGFydGVncmFwaGlxdWUvbGlicmFpcmllLWFuZ3VsYXIvbGliL3NyYy93b3JrZmxvd3Mvc3JjLyIsInNvdXJjZXMiOlsid29ya2Zsb3dzL2xzLXdvcmtmbG93LWluc3RhbmNlLXZpZXdlci9scy13b3JrZmxvdy1pbnN0YW5jZS12aWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFxQixNQUFNLGVBQWUsQ0FBQztBQUlsRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxnREFBZ0QsQ0FBQztBQUNsRixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDcEUsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sdURBQXVELENBQUM7QUFPbkksTUFBTSxPQUFPLGlDQUFpQztJQW1CNUM7UUFYQSxhQUFRLEdBQXNDO1lBQzVDLGNBQWMsRUFBRSxPQUFPO1lBQ3ZCLGFBQWEsRUFBRSxLQUFLO1NBQ3JCLENBQUM7UUFJTyxnQkFBVyxHQUFHLElBQUksQ0FBQztRQUM1QixXQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2YsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUtuQixhQUFRLEdBQTRCO1lBQ2xDLGNBQWMsRUFBRSxhQUFhO1lBQzdCLFlBQVksRUFBRSx1QkFBdUI7WUFDckMsa0JBQWtCLEVBQUUsY0FBYztZQUNsQyxpQkFBaUIsRUFBRSxjQUFjO1lBQ2pDLFNBQVMsRUFBRSxLQUFLO1NBQ2pCLENBQUM7SUFSRixDQUFDOzs7O0lBVUQsSUFBYSxPQUFPO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQztJQUN2QixDQUFDOzs7OztJQUVELElBQUksT0FBTyxDQUFDLEtBQThCO1FBQ3hDLElB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QUFDLGlCQUFpQixDQUFDO2FBQ3ZDO2lCQUFNO2dCQUNMLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQzthQUN4QztTQUNGO1FBQ0QsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDOzs7WUE5SkYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSw2QkFBNkI7Z0JBQ3ZDLGs0RUFBMkQ7O2FBRTVEOzs7OztvQ0FJRSxZQUFZLFNBQUMsbUJBQW1CO3FDQUNoQyxZQUFZLFNBQUMsb0JBQW9COzJCQUVqQyxLQUFLLFNBQUMsS0FBSzt5QkFDWCxLQUFLO2tDQUtMLEtBQUs7Z0NBQ0wsS0FBSztnREFDTCxLQUFLOzBCQUNMLEtBQUs7c0JBZUwsS0FBSztnQ0FRTCxLQUFLOzs7O0lBbkNOLGtFQUEyRTs7SUFDM0UsbUVBQTZFOztJQUU3RSx5REFBNkM7O0lBQzdDLHVEQUE0Qjs7SUFDNUIscURBR0U7O0lBQ0YsZ0VBQTBEOztJQUMxRCw4REFBd0Q7O0lBQ3hELDhFQUE4RDs7SUFDOUQsd0RBQTRCOztJQUM1QixtREFBZTs7SUFDZix1REFBbUI7O0lBS25CLHFEQU1FIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBDb250ZW50Q2hpbGQsIElucHV0LCBPbkNoYW5nZXMsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU3RlcEluc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL21vZGVsL3dvcmtmbG93cy9zdGVwLWluc3RhbmNlJztcbmltcG9ydCB7IFdvcmtmbG93QWN0b3IgfSBmcm9tICcuLi8uLi9zaGFyZWQvbW9kZWwvd29ya2Zsb3dzL3dvcmtmbG93LWFjdG9yJztcbmltcG9ydCB7IFN0ZXBNb2RlbCB9IGZyb20gJy4uLy4uL3NoYXJlZC9tb2RlbC93b3JrZmxvd3Mvc3RlcC1tb2RlbCc7XG5pbXBvcnQgeyBXb3JrZmxvd0luc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL21vZGVsL3dvcmtmbG93cy93b3JrZmxvdy1pbnN0YW5jZSc7XG5pbXBvcnQgeyBTdGVwU3RhdGUgfSBmcm9tICcuLi8uLi9zaGFyZWQvbW9kZWwvd29ya2Zsb3dzL3N0ZXAtc3RhdGUnO1xuaW1wb3J0IHsgV29ya2Zsb3dJbnN0YW5jZUxvY2FsaXplZE1lc3NhZ2VzLCBXb3JrZmxvd0luc3RhbmNlT3B0aW9ucyB9IGZyb20gJy4uLy4uL3NoYXJlZC9tb2RlbC93b3JrZmxvd3Mvd29ya2Zsb3ctaW5zdGFuY2Utb3B0aW9uJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbHMtd29ya2Zsb3ctaW5zdGFuY2Utdmlld2VyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2xzLXdvcmtmbG93LWluc3RhbmNlLXZpZXdlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xzLXdvcmtmbG93LWluc3RhbmNlLXZpZXdlci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIExzV29ya2Zsb3dJbnN0YW5jZVZpZXdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcblxuXG4gIEBDb250ZW50Q2hpbGQoJ3Bhc3NlZFN0ZXBDb250ZW50JykgcGFzc2VkU3RlcFRlbXBsYXRlUmVmOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBAQ29udGVudENoaWxkKCdwZW5kaW5nU3RlcENvbnRlbnQnKSBwZW5kaW5nU3RlcFRlbXBsYXRlUmVmOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gIEBJbnB1dCgnc3JjJykgd29ya2Zsb3dEYXRhOiBXb3JrZmxvd0luc3RhbmNlO1xuICBASW5wdXQoKSBhY3RpdmVTdGVwOiBudW1iZXI7XG4gIG1lc3NhZ2VzOiBXb3JrZmxvd0luc3RhbmNlTG9jYWxpemVkTWVzc2FnZXMgPSB7XG4gICAgRklSU1RfU1RFUF9UWFQ6ICdTdGFydCcsXG4gICAgTEFTVF9TVEVQX1RYVDogJ0VuZCdcbiAgfTtcbiAgQElucHV0KCkgZ2V0U3RlcEljb25DbGFzc0ZjdDogKHN0ZXA6IFN0ZXBNb2RlbCkgPT4gc3RyaW5nO1xuICBASW5wdXQoKSBnZXRTdGVwVG9vbHRpcEZjdDogKHN0ZXA6IFN0ZXBNb2RlbCkgPT4gc3RyaW5nO1xuICBASW5wdXQoKSBnZXRDaXJjdWl0RW5kQWRkaXRpb25hbENsYXNzZXNGY3Q6ICgpID0+IHN0cmluZyB8IFtdO1xuICBASW5wdXQoKSByZWR1Y2VkTW9kZSA9IHRydWU7XG4gIGlzT3ZlciA9IGZhbHNlO1xuICBpc1JlamVjdGVkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gIH1cblxuICBfb3B0aW9uczogV29ya2Zsb3dJbnN0YW5jZU9wdGlvbnMgPSB7XG4gICAgc3RhcnRJY29uQ2xhc3M6ICdmYXIgZmEtZmxhZycsXG4gICAgZW5kSWNvbkNsYXNzOiAnZmFzIGZhLWZsYWctY2hlY2tlcmVkJyxcbiAgICB2YWxpZGF0ZWRJY29uQ2xhc3M6ICdmYXMgZmEtY2hlY2snLFxuICAgIHJlamVjdGVkSWNvbkNsYXNzOiAnZmFzIGZhLXRpbWVzJyxcbiAgICBoaWRlU3RhcnQ6IGZhbHNlXG4gIH07XG5cbiAgQElucHV0KCkgZ2V0IG9wdGlvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX29wdGlvbnM7XG4gIH1cblxuICBzZXQgb3B0aW9ucyh2YWx1ZTogV29ya2Zsb3dJbnN0YW5jZU9wdGlvbnMpIHtcbiAgICB0aGlzLl9vcHRpb25zID0gT2JqZWN0LmFzc2lnbih0aGlzLl9vcHRpb25zLCB2YWx1ZSk7XG4gIH1cblxuICBASW5wdXQoKSBnZXQgbG9jYWxpemVkTWVzc2FnZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMubWVzc2FnZXM7XG4gIH1cblxuICBzZXQgbG9jYWxpemVkTWVzc2FnZXModmFsdWU6IFdvcmtmbG93SW5zdGFuY2VMb2NhbGl6ZWRNZXNzYWdlcykge1xuICAgIHRoaXMubWVzc2FnZXMgPSBPYmplY3QuYXNzaWduKHRoaXMubWVzc2FnZXMsIHZhbHVlKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGNvbnNvbGUud2FybignaW5zdGFuY2lhdGluZyBscyB3b3JrZmxvdyBpbnN0YW5jZSB2aWV3ZXIhJyk7XG4gICAgaWYgKCF0aGlzLndvcmtmbG93RGF0YSkge1xuICAgICAgY29uc29sZS5lcnJvcignTWlzc2luZyBpbnB1dCBjaXJjdWl0IGRhdGEnKTtcbiAgICAgIHRoaXMud29ya2Zsb3dEYXRhID0gbmV3IFdvcmtmbG93SW5zdGFuY2UoKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMubWVzc2FnZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsb2NhbGlzZWQgbWVzc2FnZXMgZm9yIExzV29ya2Zsb3dWaWV3ZXJDb21wb25lbnQhJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmdldFN0ZXBJY29uQ2xhc3NGY3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZXRTdGVwSWNvbkNsYXNzRmN0IGZvciBMc1dvcmtmbG93Vmlld2VyQ29tcG9uZW50IScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5nZXRTdGVwVG9vbHRpcEZjdCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdldFN0ZXBUb29sdGlwRmN0IGZvciBMc1dvcmtmbG93Vmlld2VyQ29tcG9uZW50IScpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIGNvbnNvbGUuZGVidWcoJ0xzV29ya2Zsb3dWaWV3ZXJDb21wb25lbnQ6Om5nT25DaGFuZ2VzLCAnLCB0aGlzKTtcblxuICAgIHRoaXMuYWN0aXZlU3RlcCA9IHRoaXMud29ya2Zsb3dEYXRhLmN1cnJlbnRTdGVwSWR4O1xuICAgIHRoaXMuaXNPdmVyID0gdGhpcy53b3JrZmxvd0RhdGEuaXNPdmVyO1xuICAgIHRoaXMuaXNSZWplY3RlZCA9IHRoaXMud29ya2Zsb3dEYXRhLnJlamVjdGVkO1xuICB9XG5cbiAgZ2V0U3RlcEljb25DbGFzcyhzdGVwOiBTdGVwTW9kZWwpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmdldFN0ZXBJY29uQ2xhc3NGY3Qoc3RlcCk7XG4gIH1cblxuICBnZXRTdGVwVG9vbHRpcChzdGVwOiBTdGVwTW9kZWwpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmdldFN0ZXBUb29sdGlwRmN0KHN0ZXApO1xuICB9XG5cbiAgaXNBY3RpdmVTdGVwKHN0ZXBJZHg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5pc1JlamVjdGVkICYmICF0aGlzLmlzT3ZlciAmJiBzdGVwSWR4ID09PSB0aGlzLmFjdGl2ZVN0ZXA7XG4gIH1cblxuICBpc1Bhc3NlZChzdGVwOiBTdGVwSW5zdGFuY2UpIHtcbiAgICByZXR1cm4gKHN0ZXAuc3RhdGUgPT09IFN0ZXBTdGF0ZS5WQUxJREFURUQpIHx8IChzdGVwLnN0YXRlID09PSBTdGVwU3RhdGUuUkVKRUNURUQpO1xuICB9XG5cbiAgaXNBY3R1YWxWYWxpZGF0b3Ioc3RlcDogU3RlcEluc3RhbmNlLCB2YWxpZGF0b3I6IFdvcmtmbG93QWN0b3IpIHtcbiAgICByZXR1cm4gc3RlcC52YWxpZGF0ZWRCeS5zb21lKChlbGVtKSA9PiBlbGVtLmlkID09PSB2YWxpZGF0b3IuaWQpO1xuICB9XG5cbiAgaXNDaXJjdWl0T3ZlcigpIHtcbiAgICByZXR1cm4gdGhpcy5pc092ZXIgJiYgIXRoaXMuaXNSZWplY3RlZDtcbiAgfVxuXG4gIGdldENpcmN1aXRFbmRBZGRpdGlvbmFsQ2xhc3NlcygpOiBzdHJpbmdbXSB7XG5cbiAgICBjb25zdCBjbGFzc2VzID0gW107XG4gICAgaWYgKHRoaXMuZ2V0Q2lyY3VpdEVuZEFkZGl0aW9uYWxDbGFzc2VzRmN0KSB7XG4gICAgICBjbGFzc2VzLnB1c2godGhpcy5nZXRDaXJjdWl0RW5kQWRkaXRpb25hbENsYXNzZXNGY3QoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNsYXNzZXMucHVzaCh0aGlzLl9vcHRpb25zLmFkZGl0aW9uYWxGaW5hbEVuZHBvaW50Q2xhc3NlcyB8fCAnJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucmVkdWNlZE1vZGUpIHtcbiAgICAgIGNsYXNzZXMucHVzaCgncmVkdWNlZC1lbmQtc3RlcCcpO1xuICAgIH1cblxuICAgIHJldHVybiBjbGFzc2VzO1xuICB9XG5cbiAgZ2V0QWRkaXRpb25hbFZhbGlkYXRvckxpc3RDbGFzc2VzKCkge1xuICAgIC8vd2EtY2lyY3VpdC1pbnN0YW5jZVxuXG4gIH1cblxuXG4gIGdldFN0ZXBBZGRpdGlvbmFsQ2xhc3NlcyhzdGVwOiBTdGVwSW5zdGFuY2UsIHN0ZXBJZHg6IG51bWJlcik6IHN0cmluZ1tdIHtcbiAgICAvLyB0aGlzLmlzQWN0aXZlU3RlcChzdGVwSWR4KSA/ICd3YS1hY3RpdmUtc3RlcCB3YS13aGl0ZS1pY24nIDogJydcbiAgICBjb25zdCBjbGFzc2VzID0gW107XG4gICAgaWYgKHRoaXMuaXNBY3RpdmVTdGVwKHN0ZXBJZHgpKSB7XG4gICAgICBjbGFzc2VzLnB1c2goJ2xzLWFjdGl2ZS1zdGVwIGxzLXdoaXRlLWljbicpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnJlZHVjZWRNb2RlKSB7XG4gICAgICBjbGFzc2VzLnB1c2goJ2xzLXJlZHVjZWQtc3RlcCcpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5yZWR1Y2VkTW9kZSkge1xuICAgICAgaWYgKHN0ZXAuc3RhdGUgPT09IFN0ZXBTdGF0ZS5TS0lQUEVEKSB7XG4gICAgICAgIGNsYXNzZXMucHVzaCgnd2EtY2lyY3VpdC1za2lwcGVkLXN0ZXAnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3RlcC5zdGF0ZSA9PT0gU3RlcFN0YXRlLlZBTElEQVRFRCkge1xuICAgICAgY2xhc3Nlcy5wdXNoKCdscy12YWxpZGF0ZWQtc3RlcCcpO1xuICAgIH1cblxuICAgIHJldHVybiBjbGFzc2VzO1xuICB9XG5cbiAgZ2V0VmFsaWRhdG9yQ2xhc3NlcyhzdGVwOiBTdGVwSW5zdGFuY2UsIHZhbGlkYXRvcjogV29ya2Zsb3dBY3Rvcik6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuaXNBY3R1YWxWYWxpZGF0b3Ioc3RlcCwgdmFsaWRhdG9yKSkge1xuICAgICAgaWYgKHN0ZXAuc3RhdGUgPT09IFN0ZXBTdGF0ZS5SRUpFQ1RFRCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLnJlamVjdGVkSWNvbkNsYXNzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy52YWxpZGF0ZWRJY29uQ2xhc3M7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG59XG4iXX0=